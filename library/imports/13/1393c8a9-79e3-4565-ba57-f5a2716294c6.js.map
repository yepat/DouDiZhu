{"version":3,"sources":["../../../../assets/Script/assets/Script/GameTable.js"],"names":["PokerData","require","PokerControl","config","CardUtil","PopCardUtil","opratOutCardControl","dialogManager","PlayerDetailModel","Player","cc","Class","extends","Component","properties","pokerCard","default","type","Prefab","pokerLayerLeft","Node","pokerLayerRight","pokerLayerMy","chupaiBtn","buchuBtn","canvas","opratOutCard","onLoad","start","self","touchBeganX","leftX","rightX","upY","downY","isTouchbegan","detailModel","params","uid","getUid","nickname","getNickName","gender","toString","getGender","coin","getCoin","gold","getGold","propDress","getPropDress","wechatImg","getWechatImg","title","getTitle","emoticon","emoticonItems","player","playerme_","console","log","setPokerCard","myPokerData","myPokerNode","dispatchCard","sceneWidth","director","getWinSize","width","scene","getScene","initMyCards","registerEvent","leftPokerData","leftPokerNode","left_player","playerLeftShowCard","on","EventType","TOUCH_START","event","length","p","getLocation","x","setSelectCardByTouch","y","x1","getPositionX","x2","py","getPositionY","psize","getContentSize","pwidth","pheight","height","disBetween","moveAllCardDown","node","TOUCH_END","moveCard","TOUCH_MOVE","Math","abs","unregisterEvent","targetOff","istouchbegan","touchStart","touchEnd","selected","i","pokerNode","posY","size","posX","seatPos","center","right","left","buttom","up","getComponent","setChoosed","cardMove","cardMoveDown","onShow","onMyOutCard","onHide","topcards","getMyTopCards","mycards","push","showTxt","autocards","getCardsFromTopCards","AutoChooseLiftUpCard","removeFromParent","buchuFunc","tishiNum","tishiFunc","cards","cardstype","get_topCard_type","myCards","cardValue","StringToNumber","tishicards","get_cards_larger","stopAllActions","callFunc","delay","delayTime","runAction","sequence","chupaiFunc","topCards","isTopped","popCardsType","isChoosedPoker","unshift","splice","playCard","neatenPoker","setCardDiZhu","opOutCard","instantiate","parent","opOutCardControl","show","leftCardValue","leftCardColor","pokerDataItem","showType","sort","gradeDown","cardNode","scale","pokerScale","poker","canTouch","showPoker","neatenLeftPoker","index","playCardLeft","seatPosParam","showWidth","startX","pokerNum","needWidth","startPosX","len","setPosition","positionY","startY","cardScale","showCardWidth","moveTo","playerRightShowCard","rightPokerData","rightCardValue","rightCardColor","rightPokerNode","neatenRightPoker","putCard","playCardRight","btnBackClick","loadScene","btnDelegateClick","showJpqNode","showCancelDelegate","btnSetClick","showSetDialog","btnJiPaiQiClick","btnChatClick"],"mappings":"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","file":"GameTable.js","sourceRoot":"../../../../assets/Script","sourcesContent":["\nvar PokerData = require(\"PokerData\");\nvar PokerControl = require(\"PokerControl\");\nvar config = require(\"config\");\nvar CardUtil = require(\"CardUtil\")\nvar PopCardUtil = require(\"PopCardUtil\")\nvar opratOutCardControl = require(\"opratOutCardControl\");\nvar dialogManager = require(\"dialogManager\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar Player = require(\"Player\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        pokerCard : {\n            default : null,\n            type : cc.Prefab\n        },\n\n        pokerLayerLeft:{\n            default : null,\n            type : cc.Node,\n        },\n        pokerLayerRight:{\n            default : null,\n            type : cc.Node,\n        },\n        pokerLayerMy:{\n            default : null,\n            type : cc.Node,\n        },\n\n        chupaiBtn : {\n            default : null,\n            type : cc.Node,\n        },\n\n        buchuBtn : {\n            default : null,\n            type : cc.Node\n        },\n        canvas:cc.Node, \n        opratOutCard:{\n            default : null,\n            type : cc.Prefab\n        },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    onLoad () {\n        \n    },\n    start () {\n        var self = this;\n    \n        self.touchBeganX = 0;\n        self.leftX = 0;\n        self.rightX = 0;\n        self.upY = 0;\n        self.downY = 0;\n        self.isTouchbegan = false;\n\n        //--创建自己的形象\n        var detailModel = PlayerDetailModel;\n        var params = {};\n        params.uid = detailModel.getUid();\n        params.nickname = detailModel.getNickName();\n        params.gender = toString(detailModel.getGender());\n        params.coin = detailModel.getCoin();\n        params.gold = detailModel.getGold();\n        params.propDress = detailModel.getPropDress();\n        params.wechatImg = detailModel.getWechatImg();\n        params.title = detailModel.getTitle();\n        params.emoticon = {};\n        params.emoticonItems = {};\n        // console.log(params);\n        var player = new Player(params);\n        self.playerme_ = player;\n        console.log(player);\n        //设置预设牌\n        self.playerme_.setPokerCard(this.pokerCard);\n        \n        //xx_test\n        var myPokerData = [];\n        var myPokerNode = [];\n        var dispatchCard = [];\n        var sceneWidth = cc.director.getWinSize().width;\n        //将预制节点放置在界面上\n        var scene = cc.director.getScene();\n\n        this.myPokerData = myPokerData;\n        this.myPokerNode = myPokerNode;\n        this.dispatchCard = dispatchCard;\n        this.sceneWidth = sceneWidth;\n        this.scene = scene;\n\n        self.playerme_.initMyCards(this.myPokerData,this.myPokerNode,this.scene,this.sceneWidth);\n\n        this.registerEvent();\n        // this.playerLeftShowCard();\n        // this.playerRightShowCard();\n\n        var leftPokerData = [];\n        var leftPokerNode = [];\n\n        var left_player = new Player(params);\n        left_player.setPokerCard(this.pokerCard);\n        left_player.playerLeftShowCard(leftPokerData,leftPokerNode,this.pokerLayerLeft,this.sceneWidth);\n        \n    },\n    //注册触摸事件\n    registerEvent(){\n        var self = this;\n        var myPokerNode = this.myPokerNode;\n\n        this.canvas.on(cc.Node.EventType.TOUCH_START, function(event){\n            // console.log(\"touchStart\");\n            if(myPokerNode.length < 1)\n            return false;\n            var p = event.getLocation();\n            // console.log(\">>x:\"+p.x+\">>y:\"+p.y);\n            self.touchBeganX = p.x;\n            self.leftX = 0;\n            self.rightX = 10000;\n            self.upY = 10000;\n            self.downY = 0;\n            self.isTouchbegan = true;\n            self.setSelectCardByTouch(myPokerNode,p.x,p.y,self.isTouchbegan);\n\n            if (self.isTouchbegan){\n                var x1 = myPokerNode[0].getPositionX();\n                var x2 = myPokerNode[myPokerNode.length-1].getPositionX();\n                var py = myPokerNode[0].getPositionY();\n                var psize = myPokerNode[0].getContentSize();\n                var pwidth = psize.width;\n                var pheight = psize.height;\n\n                var disBetween = 10;\n    \n                self.leftX = x1-pwidth/2-disBetween;\n                self.rightX = x2+pwidth/2+disBetween;\n                self.upY = py+pheight/2+40;\n                self.downY = py-pheight/2;\n\n                console.log(\"self.leftX:\"+self.leftX+\"  self.rightX:\"+self.rightX+\" self.downY:\"+self.downY+\"  self.upY:\"+ self.upY);\n                if (self.isTouchbegan && (p.y > self.upY || p.y < self.downY || p.x < self.leftX || p.x > self.rightX)){\n                    self.moveAllCardDown(myPokerNode);\n                }\n            }\n        }, this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_END,function(event){\n            // console.log(\"touchEnd\");\n            if(myPokerNode.length < 1)\n            return;\n            var p = event.getLocation();\n            self.moveCard(myPokerNode);\n        }, this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_MOVE,function(event){\n            if(myPokerNode.length < 1)\n            return;\n            var p = event.getLocation();\n            if (Math.abs(self.touchBeganX - p.x) > 40){\n                self.isTouchbegan = false;\n                self.setSelectCardByTouch(myPokerNode,p.x,p.y,self.isTouchbegan);\n            }\n        }, this.node);\n    },\n    //移除触摸事件\n    unregisterEvent(){\n        this.canvas.targetOff(this.node);\n        console.log(\"off\");\n    },\n    setSelectCardByTouch(myPokerNode,x,y,istouchbegan){\n        var touchStart = this.touchBeganX;\n        var touchEnd = x;\n        this.isTouchbegan = istouchbegan;\n\n        if (this.touchBeganX > x){\n            touchStart = x;\n            touchEnd = this.touchBeganX; \n        }\n        //如果起点跟终点距离小于5 则处理成起点等于终点\n        if (touchEnd - touchStart<5){\n            touchEnd = touchStart;\n        }\n\n        var selected = false; //选中状态\n        \n        for(var i = 0;i < myPokerNode.length;i++){\n            var pokerNode = myPokerNode[i];\n            var posY = pokerNode.getPositionY();\n            var size = pokerNode.getContentSize();\n            var posX = pokerNode.getPositionX(); //+ size.width/2;\n\n            var width = size.width;\n            var height = size.height;\n\n            var disBetween = config.seatPos.center.disBetween;\n\n            var right = posX - width/2+disBetween;\n            var left =  posX - width/2;\n            var buttom = posY - height/2;\n            var up = posY + height/2;\n            //最后一张整张牌都可以点击\n            if(i == myPokerNode.length-1){\n                right = posX+width/2; \n            }\n            if ( y >= buttom && y <= up &&\n                ((left>= touchStart && left <= touchEnd) || (right>= touchStart && right <= touchEnd) ||\n                (touchStart>= left && touchStart <= right) || (touchEnd>= left && touchEnd <= right))){\n                    pokerNode.getComponent(PokerControl).setChoosed(true);\n                }else{\n            }\n        }   \n    },\n    moveCard(myPokerNode){\n        for(var i = 0;i < myPokerNode.length;i++){\n            var pokerNode = myPokerNode[i];\n            pokerNode.getComponent(PokerControl).cardMove();\n        }\n    },\n    moveAllCardDown(myPokerNode){\n        console.log(\"moveAllCardDown\");\n        for(var i = 0;i < myPokerNode.length;i++){\n            var pokerNode = myPokerNode[i];\n            pokerNode.getComponent(PokerControl).cardMoveDown();\n        }\n    },\n    onShow(){\n        console.log(\"onShow\");\n        this.onMyOutCard();\n    },\n    onHide(){\n        console.log(\"onHide\");\n        //智能提牌测试\n        var myPokerNode = this.myPokerNode;\n        var myPokerData = this.myPokerData;\n        var topcards = CardUtil.getMyTopCards(myPokerNode,PokerControl);\n        \n        var mycards = [];\n        for(var i = myPokerData.length - 1; i > -1;i--){\n            mycards.push(myPokerData[i].showTxt);\n            console.log(\"xx\"+myPokerData[i].showTxt);\n        } \n        \n        var autocards = CardUtil.getCardsFromTopCards(mycards,topcards);\n        if(autocards.length < 1){\n        }else{\n            this.moveAllCardDown(myPokerNode);//先放下在提起\n            CardUtil.AutoChooseLiftUpCard(myPokerNode,PokerControl,autocards);\n        } \n    },\n    //轮到自己出牌\n    onMyOutCard(){\n        var self = this;\n        var dispatchCard = this.dispatchCard;\n        var sceneWidth = this.sceneWidth;\n        var scene = cc.director.getScene();\n\n        var myPokerNode = this.myPokerNode;\n        var myPokerData = this.myPokerData;\n\n        //牌桌上已经有了出牌，清除掉\n        if(dispatchCard.length > 0){\n            console.log(\"dispatchCard.length:\"+dispatchCard.length);\n            for(var i = 0; i < dispatchCard.length; i++){\n                dispatchCard[i].getComponent(PokerControl).node.removeFromParent();\n            }\n            dispatchCard = [];\n        }\n\n        var buchuFunc = function(){\n            self.moveAllCardDown(myPokerNode);\n        }\n        var tishiNum = 0;\n        var tishiFunc = function(){\n            var cards = [5,5,5,6,6,6,7,7];//\"3\",\"3\",\"3\",\"3\"\n            var cardstype = CardUtil.get_topCard_type(cards);\n            var myCards = [];\n            console.log(cardstype);\n            for(var i = myPokerData.length - 1; i > -1;i--){\n                var cardValue = CardUtil.StringToNumber(myPokerData[i].showTxt);\n                myCards.push(cardValue); \n            }\n\n            var tishicards = CardUtil.get_cards_larger(cardstype,myCards);\n            if(tishicards.length == 0){\n                console.log(\"没有符合的牌型可供提示\");\n                return;\n            }\n            cards = tishicards[tishiNum];\n            if(tishiNum<tishicards.length-1){\n                tishiNum++;\n            }else{\n                tishiNum = 0;\n            }\n\n            this.node.stopAllActions();\n            var callFunc = cc.callFunc(function(){\n                CardUtil.AutoChooseLiftUpCard(myPokerNode,PokerControl,cards);\n            });\n            var delay = cc.delayTime(0.25);\n            this.node.runAction(cc.sequence(delay,callFunc));\n            self.moveAllCardDown(myPokerNode);\n        }\n        var chupaiFunc = function(){\n            console.log(\"点击了出牌\");\n            var topCards = [];\n            //获取提起的牌直\n            for(var i = myPokerData.length - 1; i > -1;i--){\n                if(myPokerData[i].isTopped){\n                    var cardValue = CardUtil.StringToNumber(myPokerData[i].showTxt);\n                    topCards.push(cardValue);\n                }\n            }\n\n            if(topCards.length>=1){\n                var popCardsType = CardUtil.get_topCard_type(topCards);\n                console.log(popCardsType);\n                if(popCardsType.type == 0){\n                    console.log(\"提起的牌不合法\");\n                    return -1;\n                }    \n            }else{\n                console.log(\"没有牌提起\");\n                return 0;\n            }\n\n            for(var i = myPokerData.length - 1; i > -1;i--){\n                    if(myPokerData[i].isTopped){ //myPokerData[i].isChoosed\n                    var isChoosedPoker = myPokerNode[i];\n                    dispatchCard.unshift(isChoosedPoker);\n                    myPokerData.splice(i,1);\n                    myPokerNode.splice(i,1);\n                }\n            }\n            self.dispatchCard = dispatchCard;\n            //出牌\n            self.playerme_.playCard(dispatchCard);\n            self.playerme_.neatenPoker(myPokerNode,config.seatPos.center,sceneWidth);\n            //最后一张牌设置为地主牌\n            if(myPokerNode.length>0){\n                myPokerNode[myPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\n            }\n        }\n        var opOutCard = cc.instantiate(this.opratOutCard);\n        opOutCard.parent = scene;\n        var opOutCardControl = opOutCard.getComponent(opratOutCardControl);\n        opOutCardControl.show(20,buchuFunc,tishiFunc,chupaiFunc);\n    },\n    playerLeftShowCard(){\n        var leftPokerData = [];\n        var leftCardValue = [\n            3,5,5,5,5,6,6,6,6,9,9,9,10,10,10,\"J\",\"J\"//,\"J\",\"g\",\"G\"\n        ];\n        var leftCardColor = [\n            1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,\"smallG\",\"bigG\"\n        ]; \n        for(var i = 0;i < leftCardValue.length;i++){\n            var pokerDataItem = {\n                showTxt : leftCardValue[i],\n                showType : leftCardColor[i]\n            }\n            leftPokerData.push(pokerDataItem);\n        }\n        leftPokerData.sort(CardUtil.gradeDown);\n\n        var leftPokerNode = [];\n        var dispatchCard = [];\n        var sceneWidth = cc.director.getWinSize().width;\n        var scene = this.pokerLayerLeft;\n\n        for(var i = 0;i < leftPokerData.length;i++){\n            var cardNode = cc.instantiate(this.pokerCard);\n            cardNode.parent = scene;\n            cardNode.scale = config.seatPos.left.pokerScale;\n            var poker = cardNode.getComponent(PokerControl);\n            leftPokerData[i].canTouch = false;\n            poker.showPoker(leftPokerData[i]);\n            leftPokerNode.push(cardNode);\n            this.neatenLeftPoker(leftPokerNode,config.seatPos.left,sceneWidth/2, 230);\n        }\n        leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\n\n        //出牌\n        var cards = [5,5,5,5];//,5,5,5,5,6,6,6,6,9,9,9,10,10,10\n        // cards.sort(config.arrayDown);\n        var index = 0;\n        for(var i = leftPokerData.length - 1; i > -1;i--){\n            var cardValue = CardUtil.StringToNumber(leftPokerData[i].showTxt);\n            // var index = leftPokerData.length - 1 - i;\n            console.log(\"cardValue:\"+cardValue+\"index:\"+index);\n\n            if(index<cards.length&&cards[index]==cardValue){ //myPokerData[i].isChoosed\n                console.log(\"cards:\"+cards[index]);\n                var isChoosedPoker = leftPokerNode[i];\n                dispatchCard.unshift(isChoosedPoker);\n                leftPokerData.splice(i,1);\n                leftPokerNode.splice(i,1);\n                index++;\n            }\n        }\n        //出牌\n        this.playCardLeft(dispatchCard,320,650);\n        this.neatenLeftPoker(leftPokerNode,config.seatPos.left,sceneWidth/2, 230);\n        //最后一张牌设置为地主牌\n        if(leftPokerNode.length>0){\n            leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\n        }\n\n    },\n    neatenLeftPoker(pokerNode,seatPosParam,showWidth,startX){\n        if(pokerNode.length < 1){return}\n        var pokerNum = pokerNode.length;\n        var needWidth = (pokerNum - 1) * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale;\n        showWidth = showWidth || cc.director.getWinSize().width;\n        var startPosX = (showWidth - needWidth) / 2;\n        startX = startX || startPosX;\n\n        var len = pokerNode.length;\n        if(len<=10){\n            for(var i = 0; i < pokerNode.length; i++){\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\n            }\n        }else{\n            for(var i = 0; i < 10; i++){\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\n            }\n\n            for(var i=0;i<len-10;i++){\n                pokerNode[i+10].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY-55);\n            }\n        }\n    },\n    //左边出牌\n    playCardLeft(pokerNode,startX,startY){\n        if(pokerNode.length < 1){return}\n        var cardScale = 0.38;\n        var disBetween = 27;\n        var showCardWidth = (pokerNode.length - 1) * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale;\n        var sceneWidth = cc.director.getWinSize().width;\n    \n        // console.log(\"startX:\"+startX);\n        //设置出去的牌的大小\n        for(var i = 0; i < pokerNode.length; i++){\n            pokerNode[i].scale = cardScale;\n            var posX = startX + i * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale * 0.5;\n            // console.log(\"posX:\"+posX);\n            var poker = pokerNode[i].getComponent(PokerControl);\n            poker.node.runAction(cc.moveTo(0.2,posX,startY));\n\n            if(i==pokerNode.length-1){\n                poker.setCardDiZhu(true);\n            }\n        }\n    },\n\n    //右边玩家明牌\n    playerRightShowCard(){\n\n        var rightPokerData = [];\n        var rightCardValue = [\n            3,5,5,5,5,6,6,6,6,9,9,9,10,10,10,\"J\",\"J\",\"J\",\"g\",\"G\"\n        ];\n        var rightCardColor = [\n            1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,\"smallG\",\"bigG\"\n        ]; \n        for(var i = 0;i < rightCardValue.length;i++){\n            var pokerDataItem = {\n                showTxt : rightCardValue[i],\n                showType : rightCardColor[i]\n            }\n            rightPokerData.push(pokerDataItem);\n        }\n        rightPokerData.sort(CardUtil.gradeDown);\n\n        var rightPokerNode = [];\n        var dispatchCard = [];\n        var sceneWidth = cc.director.getWinSize().width;\n        var scene = this.pokerLayerRight;\n\n        for(var i = 0;i < rightPokerData.length;i++){\n            var cardNode = cc.instantiate(this.pokerCard);\n            cardNode.parent = scene;\n            cardNode.scale = config.seatPos.right.pokerScale;\n            var poker = cardNode.getComponent(PokerControl);\n            rightPokerData[i].canTouch = false;\n            poker.showPoker(rightPokerData[i]);\n            rightPokerNode.push(cardNode);\n            this.neatenRightPoker(rightPokerNode,config.seatPos.right,sceneWidth/2, sceneWidth/2 + 140);\n        }\n\n         //出牌\n         var cards = [9,9,9,10,10,10,\"J\",\"J\",\"J\"];//,5,5,5,5,6,6,6,6\n         // cards.sort(config.arrayDown);\n         var index = 0;\n         for(var i = rightPokerData.length - 1; i > -1;i--){\n             var cardValue = CardUtil.StringToNumber(rightPokerData[i].showTxt);\n             var putCard = CardUtil.StringToNumber(cards[index]);\n             console.log(\"cardValueB:\"+cardValue+\"indexB:\"+index);\n        \n             if(index<cards.length&&putCard==cardValue){ //myPokerData[i].isChoosed\n                 console.log(\"cardsB:\"+cards[index]);\n                 var isChoosedPoker = rightPokerNode[i];\n                 dispatchCard.unshift(isChoosedPoker);\n                 rightPokerData.splice(i,1);\n                 rightPokerNode.splice(i,1);\n                 index++;\n             }\n             \n         }\n         // self.dispatchCard = dispatchCard;\n         //出牌\n         this.playCardRight(dispatchCard,620,650);\n         this.neatenRightPoker(rightPokerNode,config.seatPos.right,sceneWidth/2, sceneWidth/2 + 140);\n         //最后一张牌设置为地主牌\n        //  if(leftPokerNode.length>0){\n        //      leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\n        //  }\n    },\n    neatenRightPoker(pokerNode,seatPosParam,showWidth,startX){\n        if(pokerNode.length < 1){return}\n        var pokerNum = pokerNode.length;\n        var needWidth = (pokerNum - 1) * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale;\n        showWidth = showWidth || cc.director.getWinSize().width;\n        var startPosX = (showWidth - needWidth) / 2;\n        startX = startX || startPosX;\n\n        startX = startX + 10*seatPosParam.disBetween;\n\n        var len = pokerNode.length;\n        if(len<=10){\n            startX = startX + (10 - len)*seatPosParam.disBetween;\n            for(var i = 0; i < pokerNode.length; i++){\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\n            }\n        }else{\n            for(var i = 0; i < 10; i++){\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\n            }\n            for(var i=0;i<len-10;i++){\n                pokerNode[i+10].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY-55);\n            }\n        }\n    },\n\n    playCardRight(pokerNode,startX,startY){\n        if(pokerNode.length < 1){return}\n        var cardScale = 0.38;\n        var disBetween = 27;\n        var showCardWidth = (pokerNode.length - 1) * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale;\n        var sceneWidth = cc.director.getWinSize().width;\n        startX = sceneWidth/2 + 590 - disBetween*pokerNode.length;\n\n        //设置出去的牌的大小\n        for(var i = 0; i < pokerNode.length; i++){\n            pokerNode[i].scale = cardScale;\n            var posX = startX + i * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale * 0.5;\n            var poker = pokerNode[i].getComponent(PokerControl);\n            poker.node.runAction(cc.moveTo(0.2,posX,startY));\n            // if(i==pokerNode.length-1){\n            //     poker.setCardDiZhu(true);\n            // }\n        }\n    },\n\n    //按钮点击事件\n    btnBackClick(){\n        console.log(\"btnBackClick\");\n        cc.director.loadScene(\"HallScene\");\n    },\n    btnDelegateClick(){\n        console.log(\"btnDelegateClick\");\n        dialogManager.showJpqNode();\n        dialogManager.showCancelDelegate();\n    },\n    btnSetClick(){\n        console.log(\"btnSetClick\");\n        dialogManager.showSetDialog();\n    },\n    btnJiPaiQiClick(){\n        console.log(\"btnJiPaiQiClick\");\n    },\n    btnChatClick(){\n        console.log(\"btnChatClick\");\n    }\n});\n"]}