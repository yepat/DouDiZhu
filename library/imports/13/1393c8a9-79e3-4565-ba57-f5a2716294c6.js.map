{"version":3,"sources":["../../../../assets/Script/assets/Script/GameTable.js"],"names":["PokerData","require","PokerControl","config","CardUtil","PopCardUtil","opratOutCardControl","cc","Class","extends","Component","properties","pokerCard","default","type","Prefab","pokerLayerLeft","Node","pokerLayerRight","pokerLayerMy","chupaiBtn","buchuBtn","canvas","opratOutCard","onLoad","load","start","self","touchBeganX","leftX","rightX","upY","downY","isTouchbegan","allPeoplePokerData","getPartCardsData","leftPokerData","rightPokerData","myPokerData","console","log","seatPos","myCardValue","myCardColor","i","length","pokerDataItem","showTxt","showType","push","sort","gradeDown","myPokerNode","leftPokerNode","rightPokerNode","dispatchCard","sceneWidth","director","getWinSize","width","scene","getScene","cardNode","instantiate","parent","scale","center","pokerScale","poker","getComponent","canTouch","showPoker","neatenPoker","setCardDiZhu","registerEvent","playerLeftShowCard","playerRightShowCard","pokerNode","seatPosParam","showWidth","startX","pokerNum","needWidth","disBetween","node","startPosX","setPosition","positionY","playCard","cardScale","showCardWidth","posX","move","moveTo","easing","easeIn","runAction","on","EventType","TOUCH_START","event","p","getLocation","x","setSelectCardByTouch","y","x1","getPositionX","x2","py","getPositionY","psize","getContentSize","pwidth","pheight","height","moveAllCardDown","TOUCH_END","moveCard","TOUCH_MOVE","Math","abs","unregisterEvent","targetOff","istouchbegan","touchStart","touchEnd","selected","posY","size","right","left","buttom","up","setChoosed","cardMove","cardMoveDown","onShow","onMyOutCard","onHide","topcards","getMyTopCards","mycards","autocards","getCardsFromTopCards","AutoChooseLiftUpCard","removeFromParent","buchuFunc","tishiNum","tishiFunc","cards","cardstype","get_topCard_type","myCards","cardValue","StringToNumber","tishicards","get_cards_larger","stopAllActions","callFunc","delay","delayTime","sequence","chupaiFunc","topCards","isTopped","popCardsType","isChoosedPoker","unshift","splice","opOutCard","opOutCardControl","show","leftCardValue","leftCardColor","neatenLeftPoker","index","playCardLeft","len","startY","rightCardValue","rightCardColor","neatenRightPoker","playCardRight","btnBackClick","loadScene","btnDelegateClick","loader","loadRes","err","prefab","newNode","addChild","btnSetClick","btnJiPaiQiClick","btnChatClick"],"mappings":";;;;;;AACA,IAAIA,YAAYC,QAAQ,WAAR,CAAhB;AACA,IAAIC,eAAeD,QAAQ,cAAR,CAAnB;AACA,IAAIE,SAASF,QAAQ,QAAR,CAAb;;AAEA,IAAIG,WAAWH,QAAQ,UAAR,CAAf;AACA,IAAII,cAAcJ,QAAQ,aAAR,CAAlB;;AAEA,IAAIK,sBAAsBL,QAAQ,qBAAR,CAA1B;;AAEAM,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAY;AACRC,qBAAU,IADF;AAERC,kBAAOP,GAAGQ;AAFF,SADJ;;AAMRC,wBAAe;AACXH,qBAAU,IADC;AAEXC,kBAAOP,GAAGU;AAFC,SANP;AAURC,yBAAgB;AACZL,qBAAU,IADE;AAEZC,kBAAOP,GAAGU;AAFE,SAVR;AAcRE,sBAAa;AACTN,qBAAU,IADD;AAETC,kBAAOP,GAAGU;AAFD,SAdL;;AAmBRG,mBAAY;AACRP,qBAAU,IADF;AAERC,kBAAOP,GAAGU;AAFF,SAnBJ;;AAwBRI,kBAAW;AACPR,qBAAU,IADH;AAEPC,kBAAOP,GAAGU;AAFH,SAxBH;AA4BRK,gBAAOf,GAAGU,IA5BF;AA6BRM,sBAAa;AACTV,qBAAU,IADD;AAETC,kBAAOP,GAAGQ;AAFD;AA7BL,KAHP;;AAsCL;AACAS,UAvCK,oBAuCK;AACN;AACAxB,kBAAUyB,IAAV;AACH,KA1CI;AA2CLC,SA3CK,mBA2CI;AACL,YAAIC,OAAO,IAAX;;AAEAA,aAAKC,WAAL,GAAmB,CAAnB;AACAD,aAAKE,KAAL,GAAa,CAAb;AACAF,aAAKG,MAAL,GAAc,CAAd;AACAH,aAAKI,GAAL,GAAW,CAAX;AACAJ,aAAKK,KAAL,GAAa,CAAb;AACAL,aAAKM,YAAL,GAAoB,KAApB;AACA;AACA,YAAIC,qBAAqBlC,UAAUmC,gBAAV,EAAzB;AACA,YAAIC,gBAAgBF,mBAAmB,CAAnB,CAApB;AACA,YAAIG,iBAAiBH,mBAAmB,CAAnB,CAArB;AACA,YAAII,cAAcJ,mBAAmB,CAAnB,CAAlB;AACAK,gBAAQC,GAAR,CAAYrC,OAAOsC,OAAnB;;AAEA;AACAH,sBAAc,EAAd;AACA,YAAII,cAAc,CACd,CADc,EACZ,CADY,EACV,CADU,EACR,CADQ,EACN,CADM,EACJ,CADI,EACF,CADE,EACA,CADA,EACE,CADF,EACI,CADJ,EACM,CADN,EACQ,CADR,EACU,EADV,EACa,EADb,EACgB,EADhB,EACmB,GADnB,EACuB,GADvB,EAC2B,GAD3B,EAC+B,GAD/B,EACmC,GADnC,CACsC;AADtC,SAAlB;AAGA,YAAIC,cAAc,CACd,CADc,EACZ,CADY,EACV,CADU,EACR,CADQ,EACN,CADM,EACJ,CADI,EACF,CADE,EACA,CADA,EACE,CADF,EACI,CADJ,EACM,CADN,EACQ,CADR,EACU,CADV,EACY,CADZ,EACc,CADd,EACgB,CADhB,EACkB,CADlB,EACoB,CADpB,EACsB,CADtB,EACwB,CADxB,CACyB;AADzB,SAAlB;AAGA,aAAI,IAAIC,IAAI,CAAZ,EAAcA,IAAIF,YAAYG,MAA9B,EAAqCD,GAArC,EAAyC;AACrC,gBAAIE,gBAAgB;AAChBC,yBAAUL,YAAYE,CAAZ,CADM;AAEhBI,0BAAWL,YAAYC,CAAZ;AAFK,aAApB;AAIAN,wBAAYW,IAAZ,CAAiBH,aAAjB;AACH;AACDR,oBAAYY,IAAZ,CAAiB9C,SAAS+C,SAA1B;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAKA,YAAIC,cAAc,EAAlB;AACA,YAAIC,gBAAgB,EAApB;AACA,YAAIC,iBAAiB,EAArB;AACA,YAAIC,eAAe,EAAnB;AACA,YAAIC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA;AACA,YAAIC,QAAQrD,GAAGkD,QAAH,CAAYI,QAAZ,EAAZ;AACA;;AAEAtB,gBAAQC,GAAR,CAAY,gBAAcgB,UAA1B;;AAGA,aAAI,IAAIZ,IAAI,CAAZ,EAAcA,IAAIN,YAAYO,MAA9B,EAAqCD,GAArC,EAAyC;AACrC,gBAAIkB,WAAWvD,GAAGwD,WAAH,CAAe,KAAKnD,SAApB,CAAf;AACAkD,qBAASE,MAAT,GAAkBJ,KAAlB;AACAE,qBAASG,KAAT,GAAiB9D,OAAOsC,OAAP,CAAeyB,MAAf,CAAsBC,UAAvC;AACA,gBAAIC,QAAQN,SAASO,YAAT,CAAsBnE,YAAtB,CAAZ;AACAoC,wBAAYM,CAAZ,EAAe0B,QAAf,GAA0B,IAA1B;AACAF,kBAAMG,SAAN,CAAgBjC,YAAYM,CAAZ,CAAhB;AACAQ,wBAAYH,IAAZ,CAAiBa,QAAjB;AACA,iBAAKU,WAAL,CAAiBpB,WAAjB,EAA6BjD,OAAOsC,OAAP,CAAeyB,MAA5C,EAAmDV,UAAnD;AACH;AACD;AACAJ,oBAAYA,YAAYP,MAAZ,GAAmB,CAA/B,EAAkCwB,YAAlC,CAA+CnE,YAA/C,EAA6DuE,YAA7D,CAA0E,IAA1E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAKnC,WAAL,GAAmBA,WAAnB;AACA,aAAKc,WAAL,GAAmBA,WAAnB;AACA,aAAKG,YAAL,GAAoBA,YAApB;;AAEA,aAAKC,UAAL,GAAkBA,UAAlB;AACA,aAAKI,KAAL,GAAaA,KAAb;AACA,aAAKc,aAAL;;AAEA,aAAKC,kBAAL;AACA,aAAKC,mBAAL;AACH,KA1JI;;AA2JL;AACAJ,eA5JK,uBA4JOK,SA5JP,EA4JiBC,YA5JjB,EA4J8BC,SA5J9B,EA4JwCC,MA5JxC,EA4J+C;AAChD,YAAGH,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAIoC,WAAWJ,UAAUhC,MAAzB;AACA,YAAIqC,YAAY,CAACD,WAAW,CAAZ,IAAiBH,aAAaK,UAA9B,GAA2CN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAA7H;AACA;AACAY,oBAAYA,aAAaxE,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAAlD;AACA,YAAI0B,YAAY,CAACN,YAAYG,SAAb,IAA0B,CAA1C;AACAF,iBAASA,UAAUK,SAAnB;AACA,aAAI,IAAIzC,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,sBAAUjC,CAAV,EAAa0C,WAAb,CAAyBN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAA/I,EAAmJW,aAAaS,SAAhK;AACH;AACJ,KAvKI;;AAwKL;AACAC,YAzKK,oBAyKIX,SAzKJ,EAyKc;AACf,YAAGA,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAI4C,YAAY,IAAhB;AACA,YAAIN,aAAa,EAAjB;AACA,YAAIO,gBAAgB,CAACb,UAAUhC,MAAV,GAAmB,CAApB,IAAyBsC,UAAzB,GAAsCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAA/G;AACA;AACA,YAAIjC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA,YAAIqB,SAAS,CAACxB,aAAakC,aAAd,IAA+B,CAA5C;AACA;AACA;AACA,aAAI,IAAI9C,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,sBAAUjC,CAAV,EAAaqB,KAAb,GAAqBwB,SAArB;AACA,gBAAIE,OAAOX,SAASpC,IAAIuC,UAAb,GAA0BN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAArD,GAAiE,GAAtG;AACA;AACA,gBAAIG,OAAOrF,GAAGsF,MAAH,CAAU,GAAV,EAAcF,IAAd,EAAmB,GAAnB,CAAX;AACAC,iBAAKE,MAAL,CAAYvF,GAAGwF,MAAH,CAAU,CAAV,CAAZ;AACA,gBAAI3B,QAAQS,UAAUjC,CAAV,EAAayB,YAAb,CAA0BnE,YAA1B,CAAZ;AACAkE,kBAAMgB,IAAN,CAAWY,SAAX,CAAqBJ,IAArB;;AAEA,gBAAGhD,KAAGiC,UAAUhC,MAAV,GAAiB,CAAvB,EAAyB;AACrBuB,sBAAMK,YAAN,CAAmB,IAAnB;AACH;AACJ;AACJ,KAhMI;;AAiML;AACAC,iBAlMK,2BAkMU;AACX,YAAI/C,OAAO,IAAX;AACA,YAAIyB,cAAc,KAAKA,WAAvB;;AAEA,aAAK9B,MAAL,CAAY2E,EAAZ,CAAe1F,GAAGU,IAAH,CAAQiF,SAAR,CAAkBC,WAAjC,EAA8C,UAASC,KAAT,EAAe;AACzD;AACA,gBAAGhD,YAAYP,MAAZ,GAAqB,CAAxB,EACA,OAAO,KAAP;AACA,gBAAIwD,IAAID,MAAME,WAAN,EAAR;AACA;AACA3E,iBAAKC,WAAL,GAAmByE,EAAEE,CAArB;AACA5E,iBAAKE,KAAL,GAAa,CAAb;AACAF,iBAAKG,MAAL,GAAc,KAAd;AACAH,iBAAKI,GAAL,GAAW,KAAX;AACAJ,iBAAKK,KAAL,GAAa,CAAb;AACAL,iBAAKM,YAAL,GAAoB,IAApB;AACAN,iBAAK6E,oBAAL,CAA0BpD,WAA1B,EAAsCiD,EAAEE,CAAxC,EAA0CF,EAAEI,CAA5C,EAA8C9E,KAAKM,YAAnD;;AAEA,gBAAIN,KAAKM,YAAT,EAAsB;AAClB,oBAAIyE,KAAKtD,YAAY,CAAZ,EAAeuD,YAAf,EAAT;AACA,oBAAIC,KAAKxD,YAAYA,YAAYP,MAAZ,GAAmB,CAA/B,EAAkC8D,YAAlC,EAAT;AACA,oBAAIE,KAAKzD,YAAY,CAAZ,EAAe0D,YAAf,EAAT;AACA,oBAAIC,QAAQ3D,YAAY,CAAZ,EAAe4D,cAAf,EAAZ;AACA,oBAAIC,SAASF,MAAMpD,KAAnB;AACA,oBAAIuD,UAAUH,MAAMI,MAApB;;AAEA,oBAAIhC,aAAa,EAAjB;;AAEAxD,qBAAKE,KAAL,GAAa6E,KAAGO,SAAO,CAAV,GAAY9B,UAAzB;AACAxD,qBAAKG,MAAL,GAAc8E,KAAGK,SAAO,CAAV,GAAY9B,UAA1B;AACAxD,qBAAKI,GAAL,GAAW8E,KAAGK,UAAQ,CAAX,GAAa,EAAxB;AACAvF,qBAAKK,KAAL,GAAa6E,KAAGK,UAAQ,CAAxB;;AAEA3E,wBAAQC,GAAR,CAAY,gBAAcb,KAAKE,KAAnB,GAAyB,gBAAzB,GAA0CF,KAAKG,MAA/C,GAAsD,cAAtD,GAAqEH,KAAKK,KAA1E,GAAgF,aAAhF,GAA+FL,KAAKI,GAAhH;AACA,oBAAIJ,KAAKM,YAAL,KAAsBoE,EAAEI,CAAF,GAAM9E,KAAKI,GAAX,IAAkBsE,EAAEI,CAAF,GAAM9E,KAAKK,KAA7B,IAAsCqE,EAAEE,CAAF,GAAM5E,KAAKE,KAAjD,IAA0DwE,EAAEE,CAAF,GAAM5E,KAAKG,MAA3F,CAAJ,EAAuG;AACnGH,yBAAKyF,eAAL,CAAqBhE,WAArB;AACH;AACJ;AACJ,SAlCD,EAkCG,KAAKgC,IAlCR;AAmCA,aAAK9D,MAAL,CAAY2E,EAAZ,CAAe1F,GAAGU,IAAH,CAAQiF,SAAR,CAAkBmB,SAAjC,EAA2C,UAASjB,KAAT,EAAe;AACtD;AACA,gBAAGhD,YAAYP,MAAZ,GAAqB,CAAxB,EACA;AACA,gBAAIwD,IAAID,MAAME,WAAN,EAAR;AACA3E,iBAAK2F,QAAL,CAAclE,WAAd;AACH,SAND,EAMG,KAAKgC,IANR;AAOA,aAAK9D,MAAL,CAAY2E,EAAZ,CAAe1F,GAAGU,IAAH,CAAQiF,SAAR,CAAkBqB,UAAjC,EAA4C,UAASnB,KAAT,EAAe;AACvD,gBAAGhD,YAAYP,MAAZ,GAAqB,CAAxB,EACA;AACA,gBAAIwD,IAAID,MAAME,WAAN,EAAR;AACA,gBAAIkB,KAAKC,GAAL,CAAS9F,KAAKC,WAAL,GAAmByE,EAAEE,CAA9B,IAAmC,EAAvC,EAA0C;AACtC5E,qBAAKM,YAAL,GAAoB,KAApB;AACAN,qBAAK6E,oBAAL,CAA0BpD,WAA1B,EAAsCiD,EAAEE,CAAxC,EAA0CF,EAAEI,CAA5C,EAA8C9E,KAAKM,YAAnD;AACH;AACJ,SARD,EAQG,KAAKmD,IARR;AASH,KAzPI;;AA0PL;AACAsC,mBA3PK,6BA2PY;AACb,aAAKpG,MAAL,CAAYqG,SAAZ,CAAsB,KAAKvC,IAA3B;AACA7C,gBAAQC,GAAR,CAAY,KAAZ;AACH,KA9PI;AA+PLgE,wBA/PK,gCA+PgBpD,WA/PhB,EA+P4BmD,CA/P5B,EA+P8BE,CA/P9B,EA+PgCmB,YA/PhC,EA+P6C;AAC9C,YAAIC,aAAa,KAAKjG,WAAtB;AACA,YAAIkG,WAAWvB,CAAf;AACA,aAAKtE,YAAL,GAAoB2F,YAApB;;AAEA,YAAI,KAAKhG,WAAL,GAAmB2E,CAAvB,EAAyB;AACrBsB,yBAAatB,CAAb;AACAuB,uBAAW,KAAKlG,WAAhB;AACH;;AAED;AACA,YAAIkG,WAAWD,UAAX,GAAsB,CAA1B,EAA4B;AACxBC,uBAAWD,UAAX;AACH;;AAED,YAAIE,WAAW,KAAf,CAf8C,CAexB;;AAEtB,aAAI,IAAInF,IAAI,CAAZ,EAAcA,IAAIQ,YAAYP,MAA9B,EAAqCD,GAArC,EAAyC;AACrC,gBAAIiC,YAAYzB,YAAYR,CAAZ,CAAhB;AACA,gBAAIoF,OAAOnD,UAAUiC,YAAV,EAAX;AACA,gBAAImB,OAAOpD,UAAUmC,cAAV,EAAX;AACA,gBAAIrB,OAAOd,UAAU8B,YAAV,EAAX,CAJqC,CAIA;;AAErC,gBAAIhD,QAAQsE,KAAKtE,KAAjB;AACA,gBAAIwD,SAASc,KAAKd,MAAlB;;AAEA,gBAAIhC,aAAahF,OAAOsC,OAAP,CAAeyB,MAAf,CAAsBiB,UAAvC;;AAEA,gBAAI+C,QAAQvC,OAAOhC,QAAM,CAAb,GAAewB,UAA3B;AACA,gBAAIgD,OAAQxC,OAAOhC,QAAM,CAAzB;AACA,gBAAIyE,SAASJ,OAAOb,SAAO,CAA3B;AACA,gBAAIkB,KAAKL,OAAOb,SAAO,CAAvB;AACA;AACA,gBAAGvE,KAAKQ,YAAYP,MAAZ,GAAmB,CAA3B,EAA6B;AACzBqF,wBAAQvC,OAAKhC,QAAM,CAAnB;AACH;AACD;AACA;AACA,gBAAK8C,KAAK2B,MAAL,IAAe3B,KAAK4B,EAApB,KACCF,QAAON,UAAP,IAAqBM,QAAQL,QAA9B,IAA4CI,SAAQL,UAAR,IAAsBK,SAASJ,QAA3E,IACAD,cAAaM,IAAb,IAAqBN,cAAcK,KADnC,IAC8CJ,YAAWK,IAAX,IAAmBL,YAAYI,KAF7E,CAAL,EAE0F;AAClFrD,0BAAUR,YAAV,CAAuBnE,YAAvB,EAAqCoI,UAArC,CAAgD,IAAhD;AACH,aAJL,MAIS;AACD;AACN;AACL;AACJ,KA7SI;AA8SLhB,YA9SK,oBA8SIlE,WA9SJ,EA8SgB;AACjB,aAAI,IAAIR,IAAI,CAAZ,EAAcA,IAAIQ,YAAYP,MAA9B,EAAqCD,GAArC,EAAyC;AACrC,gBAAIiC,YAAYzB,YAAYR,CAAZ,CAAhB;AACAiC,sBAAUR,YAAV,CAAuBnE,YAAvB,EAAqCqI,QAArC;AACH;AACJ,KAnTI;AAoTLnB,mBApTK,2BAoTWhE,WApTX,EAoTuB;AACxBb,gBAAQC,GAAR,CAAY,iBAAZ;AACA,aAAI,IAAII,IAAI,CAAZ,EAAcA,IAAIQ,YAAYP,MAA9B,EAAqCD,GAArC,EAAyC;AACrC,gBAAIiC,YAAYzB,YAAYR,CAAZ,CAAhB;AACAiC,sBAAUR,YAAV,CAAuBnE,YAAvB,EAAqCsI,YAArC;AACH;AACJ,KA1TI;AA2TLC,UA3TK,oBA2TG;AACJlG,gBAAQC,GAAR,CAAY,QAAZ;AACA,aAAKkG,WAAL;AACH,KA9TI;AA+TLC,UA/TK,oBA+TG;AACJpG,gBAAQC,GAAR,CAAY,QAAZ;AACA;AACA,YAAIY,cAAc,KAAKA,WAAvB;AACA,YAAId,cAAc,KAAKA,WAAvB;AACA,YAAIsG,WAAWxI,SAASyI,aAAT,CAAuBzF,WAAvB,EAAmClD,YAAnC,CAAf;;AAEA,YAAI4I,UAAU,EAAd;AACA,aAAI,IAAIlG,IAAIN,YAAYO,MAAZ,GAAqB,CAAjC,EAAoCD,IAAI,CAAC,CAAzC,EAA2CA,GAA3C,EAA+C;AAC3CkG,oBAAQ7F,IAAR,CAAaX,YAAYM,CAAZ,EAAeG,OAA5B;AACAR,oBAAQC,GAAR,CAAY,OAAKF,YAAYM,CAAZ,EAAeG,OAAhC;AACH;;AAED,YAAIgG,YAAY3I,SAAS4I,oBAAT,CAA8BF,OAA9B,EAAsCF,QAAtC,CAAhB;AACA,YAAGG,UAAUlG,MAAV,GAAmB,CAAtB,EAAwB,CACvB,CADD,MACK;AACD,iBAAKuE,eAAL,CAAqBhE,WAArB,EADC,CACiC;AAClChD,qBAAS6I,oBAAT,CAA8B7F,WAA9B,EAA0ClD,YAA1C,EAAuD6I,SAAvD;AACH;AACJ,KAlVI;;AAmVL;AACAL,eApVK,yBAoVQ;AACT,YAAI/G,OAAO,IAAX;AACA,YAAI4B,eAAe,KAAKA,YAAxB;AACA,YAAIC,aAAa,KAAKA,UAAtB;AACA;AACA,YAAII,QAAQrD,GAAGkD,QAAH,CAAYI,QAAZ,EAAZ;;AAEA,YAAIT,cAAc,KAAKA,WAAvB;AACA,YAAId,cAAc,KAAKA,WAAvB;;AAEA;AACA,YAAGiB,aAAaV,MAAb,GAAsB,CAAzB,EAA2B;AACvBN,oBAAQC,GAAR,CAAY,yBAAuBe,aAAaV,MAAhD;AACA,iBAAI,IAAID,IAAI,CAAZ,EAAeA,IAAIW,aAAaV,MAAhC,EAAwCD,GAAxC,EAA4C;AACxCW,6BAAaX,CAAb,EAAgByB,YAAhB,CAA6BnE,YAA7B,EAA2CkF,IAA3C,CAAgD8D,gBAAhD;AACH;AACD3F,2BAAe,EAAf;AACH;;AAED,YAAI4F,YAAY,SAAZA,SAAY,GAAU;AACtBxH,iBAAKyF,eAAL,CAAqBhE,WAArB;AACH,SAFD;AAGA,YAAIgG,WAAW,CAAf;AACA,YAAIC,YAAY,SAAZA,SAAY,GAAU;AACtB;AACA,gBAAIC,QAAQ,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,CAAZ,CAFsB,CAEQ;AAC9B,gBAAIC,YAAYnJ,SAASoJ,gBAAT,CAA0BF,KAA1B,CAAhB;AACA,gBAAIG,UAAU,EAAd;AACAlH,oBAAQC,GAAR,CAAY+G,SAAZ;;AAEA,iBAAI,IAAI3G,IAAIN,YAAYO,MAAZ,GAAqB,CAAjC,EAAoCD,IAAI,CAAC,CAAzC,EAA2CA,GAA3C,EAA+C;AAC3C,oBAAI8G,YAAYtJ,SAASuJ,cAAT,CAAwBrH,YAAYM,CAAZ,EAAeG,OAAvC,CAAhB;AACA0G,wBAAQxG,IAAR,CAAayG,SAAb;AACH;;AAED,gBAAIE,aAAaxJ,SAASyJ,gBAAT,CAA0BN,SAA1B,EAAoCE,OAApC,CAAjB;;AAEA,gBAAGG,WAAW/G,MAAX,IAAqB,CAAxB,EAA0B;AACtBN,wBAAQC,GAAR,CAAY,aAAZ;AACA;AACH;;AAEDD,oBAAQC,GAAR,CAAY,SAAOoH,WAAW/G,MAA9B;AACAN,oBAAQC,GAAR,CAAYoH,UAAZ;;AAEAN,oBAAQM,WAAWR,QAAX,CAAR;;AAGA,gBAAGA,WAASQ,WAAW/G,MAAX,GAAkB,CAA9B,EAAgC;AAC5BuG;AACH,aAFD,MAEK;AACDA,2BAAW,CAAX;AACH;;AAGD,iBAAKhE,IAAL,CAAU0E,cAAV;AACA,gBAAIC,WAAWxJ,GAAGwJ,QAAH,CAAY,YAAU;AACjC3J,yBAAS6I,oBAAT,CAA8B7F,WAA9B,EAA0ClD,YAA1C,EAAuDoJ,KAAvD;AACH,aAFc,CAAf;AAGA,gBAAIU,QAAQzJ,GAAG0J,SAAH,CAAa,IAAb,CAAZ;AACA,iBAAK7E,IAAL,CAAUY,SAAV,CAAoBzF,GAAG2J,QAAH,CAAYF,KAAZ,EAAkBD,QAAlB,CAApB;;AAEApI,iBAAKyF,eAAL,CAAqBhE,WAArB;AACH,SAxCD;AAyCA,YAAI+G,aAAa,SAAbA,UAAa,GAAU;AACvB5H,oBAAQC,GAAR,CAAY,OAAZ;AACA,gBAAI4H,WAAW,EAAf;AACA;AACA,iBAAI,IAAIxH,IAAIN,YAAYO,MAAZ,GAAqB,CAAjC,EAAoCD,IAAI,CAAC,CAAzC,EAA2CA,GAA3C,EAA+C;AAC3C,oBAAGN,YAAYM,CAAZ,EAAeyH,QAAlB,EAA2B;AACvB,wBAAIX,YAAYtJ,SAASuJ,cAAT,CAAwBrH,YAAYM,CAAZ,EAAeG,OAAvC,CAAhB;AACAqH,6BAASnH,IAAT,CAAcyG,SAAd;AACH;AACJ;;AAED,gBAAGU,SAASvH,MAAT,IAAiB,CAApB,EAAsB;AAClB,oBAAIyH,eAAelK,SAASoJ,gBAAT,CAA0BY,QAA1B,CAAnB;AACA7H,wBAAQC,GAAR,CAAY8H,YAAZ;AACA,oBAAGA,aAAaxJ,IAAb,IAAqB,CAAxB,EAA0B;AACtByB,4BAAQC,GAAR,CAAY,SAAZ;AACA,2BAAO,CAAC,CAAR;AACH;AACJ,aAPD,MAOK;AACDD,wBAAQC,GAAR,CAAY,OAAZ;AACA,uBAAO,CAAP;AACH;;AAED,iBAAI,IAAII,IAAIN,YAAYO,MAAZ,GAAqB,CAAjC,EAAoCD,IAAI,CAAC,CAAzC,EAA2CA,GAA3C,EAA+C;AACvC,oBAAGN,YAAYM,CAAZ,EAAeyH,QAAlB,EAA2B;AAAE;AAC7B,wBAAIE,iBAAiBnH,YAAYR,CAAZ,CAArB;AACAW,iCAAaiH,OAAb,CAAqBD,cAArB;AACAjI,gCAAYmI,MAAZ,CAAmB7H,CAAnB,EAAqB,CAArB;AACAQ,gCAAYqH,MAAZ,CAAmB7H,CAAnB,EAAqB,CAArB;AACH;AACJ;AACDjB,iBAAK4B,YAAL,GAAoBA,YAApB;AACA;AACA5B,iBAAK6D,QAAL,CAAcjC,YAAd;AACA5B,iBAAK6C,WAAL,CAAiBpB,WAAjB,EAA6BjD,OAAOsC,OAAP,CAAeyB,MAA5C,EAAmDV,UAAnD;AACA;AACA,gBAAGJ,YAAYP,MAAZ,GAAmB,CAAtB,EAAwB;AACpBO,4BAAYA,YAAYP,MAAZ,GAAmB,CAA/B,EAAkCwB,YAAlC,CAA+CnE,YAA/C,EAA6DuE,YAA7D,CAA0E,IAA1E;AACH;AACJ,SAvCD;AAwCA,YAAIiG,YAAYnK,GAAGwD,WAAH,CAAe,KAAKxC,YAApB,CAAhB;AACA;AACAmJ,kBAAU1G,MAAV,GAAmBJ,KAAnB;AACA,YAAI+G,mBAAmBD,UAAUrG,YAAV,CAAuB/D,mBAAvB,CAAvB;AACAqK,yBAAiBC,IAAjB,CAAsB,EAAtB,EAAyBzB,SAAzB,EAAmCE,SAAnC,EAA6Cc,UAA7C;AACH,KAjcI;AAkcLxF,sBAlcK,gCAkce;AAChB,YAAIvC,gBAAgB,EAApB;AACA,YAAIyI,gBAAgB,CAChB,CADgB,EACd,CADc,EACZ,CADY,EACV,CADU,EACR,CADQ,EACN,CADM,EACJ,CADI,EACF,CADE,EACA,CADA,EACE,CADF,EACI,CADJ,EACM,CADN,EACQ,EADR,EACW,EADX,EACc,EADd,EACiB,GADjB,EACqB,GADrB,CACwB;AADxB,SAApB;AAGA,YAAIC,gBAAgB,CAChB,CADgB,EACd,CADc,EACZ,CADY,EACV,CADU,EACR,CADQ,EACN,CADM,EACJ,CADI,EACF,CADE,EACA,CADA,EACE,CADF,EACI,CADJ,EACM,CADN,EACQ,CADR,EACU,CADV,EACY,CADZ,EACc,CADd,EACgB,CADhB,EACkB,CADlB,EACoB,QADpB,EAC6B,MAD7B,CAApB;AAGA,aAAI,IAAIlI,IAAI,CAAZ,EAAcA,IAAIiI,cAAchI,MAAhC,EAAuCD,GAAvC,EAA2C;AACvC,gBAAIE,gBAAgB;AAChBC,yBAAU8H,cAAcjI,CAAd,CADM;AAEhBI,0BAAW8H,cAAclI,CAAd;AAFK,aAApB;AAIAR,0BAAca,IAAd,CAAmBH,aAAnB;AACH;AACDV,sBAAcc,IAAd,CAAmB9C,SAAS+C,SAA5B;;AAEA,YAAIE,gBAAgB,EAApB;AACA,YAAIE,eAAe,EAAnB;AACA,YAAIC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA,YAAIC,QAAQ,KAAK5C,cAAjB;;AAEA,aAAI,IAAI4B,IAAI,CAAZ,EAAcA,IAAIR,cAAcS,MAAhC,EAAuCD,GAAvC,EAA2C;AACvC,gBAAIkB,WAAWvD,GAAGwD,WAAH,CAAe,KAAKnD,SAApB,CAAf;AACAkD,qBAASE,MAAT,GAAkBJ,KAAlB;AACAE,qBAASG,KAAT,GAAiB9D,OAAOsC,OAAP,CAAe0F,IAAf,CAAoBhE,UAArC;AACA,gBAAIC,QAAQN,SAASO,YAAT,CAAsBnE,YAAtB,CAAZ;AACAkC,0BAAcQ,CAAd,EAAiB0B,QAAjB,GAA4B,KAA5B;AACAF,kBAAMG,SAAN,CAAgBnC,cAAcQ,CAAd,CAAhB;AACAS,0BAAcJ,IAAd,CAAmBa,QAAnB;AACA,iBAAKiH,eAAL,CAAqB1H,aAArB,EAAmClD,OAAOsC,OAAP,CAAe0F,IAAlD,EAAuD3E,aAAW,CAAlE,EAAqE,GAArE;AACH;AACDH,sBAAcA,cAAcR,MAAd,GAAqB,CAAnC,EAAsCwB,YAAtC,CAAmDnE,YAAnD,EAAiEuE,YAAjE,CAA8E,IAA9E;;AAEA;AACA,YAAI6E,QAAQ,CAAC,CAAD,CAAZ,CAnCgB,CAmCA;AAChB;AACA,YAAI0B,QAAQ,CAAZ;AACA,aAAI,IAAIpI,IAAIR,cAAcS,MAAd,GAAuB,CAAnC,EAAsCD,IAAI,CAAC,CAA3C,EAA6CA,GAA7C,EAAiD;AAC7C,gBAAI8G,YAAYtJ,SAASuJ,cAAT,CAAwBvH,cAAcQ,CAAd,EAAiBG,OAAzC,CAAhB;AACA;AACAR,oBAAQC,GAAR,CAAY,eAAakH,SAAb,GAAuB,QAAvB,GAAgCsB,KAA5C;;AAEA,gBAAG1B,MAAM0B,KAAN,KAAc1B,MAAM0B,KAAN,KAActB,SAA/B,EAAyC;AAAE;AACvCnH,wBAAQC,GAAR,CAAY,WAAS8G,MAAM0B,KAAN,CAArB;AACA,oBAAIT,iBAAiBlH,cAAcT,CAAd,CAArB;AACAW,6BAAaiH,OAAb,CAAqBD,cAArB;AACAnI,8BAAcqI,MAAd,CAAqB7H,CAArB,EAAuB,CAAvB;AACAS,8BAAcoH,MAAd,CAAqB7H,CAArB,EAAuB,CAAvB;AACH;AACDoI;AACH;AACD;AACA;AACA,aAAKC,YAAL,CAAkB1H,YAAlB,EAA+B,GAA/B,EAAmC,GAAnC;AACA,aAAKwH,eAAL,CAAqB1H,aAArB,EAAmClD,OAAOsC,OAAP,CAAe0F,IAAlD,EAAuD3E,aAAW,CAAlE,EAAqE,GAArE;AACA;AACA,YAAGH,cAAcR,MAAd,GAAqB,CAAxB,EAA0B;AACtBQ,0BAAcA,cAAcR,MAAd,GAAqB,CAAnC,EAAsCwB,YAAtC,CAAmDnE,YAAnD,EAAiEuE,YAAjE,CAA8E,IAA9E;AACH;AAEJ,KA/fI;AAggBLsG,mBAhgBK,2BAggBWlG,SAhgBX,EAggBqBC,YAhgBrB,EAggBkCC,SAhgBlC,EAggB4CC,MAhgB5C,EAggBmD;AACpD,YAAGH,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAIoC,WAAWJ,UAAUhC,MAAzB;AACA,YAAIqC,YAAY,CAACD,WAAW,CAAZ,IAAiBH,aAAaK,UAA9B,GAA2CN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAA7H;AACAY,oBAAYA,aAAaxE,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAAlD;AACA,YAAI0B,YAAY,CAACN,YAAYG,SAAb,IAA0B,CAA1C;AACAF,iBAASA,UAAUK,SAAnB;;AAEA,YAAI6F,MAAMrG,UAAUhC,MAApB;AACA,YAAGqI,OAAK,EAAR,EAAW;AACP,iBAAI,IAAItI,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,0BAAUjC,CAAV,EAAa0C,WAAb,CAAyBN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAA/I,EAAmJW,aAAaS,SAAhK;AACH;AACJ,SAJD,MAIK;AACD,iBAAI,IAAI3C,IAAI,CAAZ,EAAeA,IAAI,EAAnB,EAAuBA,GAAvB,EAA2B;AACvBiC,0BAAUjC,CAAV,EAAa0C,WAAb,CAAyBN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAA/I,EAAmJW,aAAaS,SAAhK;AACH;;AAED,iBAAI,IAAI3C,IAAE,CAAV,EAAYA,IAAEsI,MAAI,EAAlB,EAAqBtI,GAArB,EAAyB;AACrBiC,0BAAUjC,IAAE,EAAZ,EAAgB0C,WAAhB,CAA4BN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAAlJ,EAAsJW,aAAaS,SAAb,GAAuB,EAA7K;AACH;AACJ;AACJ,KAthBI;;AAuhBL;AACA0F,gBAxhBK,wBAwhBQpG,SAxhBR,EAwhBkBG,MAxhBlB,EAwhByBmG,MAxhBzB,EAwhBgC;AACjC,YAAGtG,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAI4C,YAAY,IAAhB;AACA,YAAIN,aAAa,EAAjB;AACA,YAAIO,gBAAgB,CAACb,UAAUhC,MAAV,GAAmB,CAApB,IAAyBsC,UAAzB,GAAsCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAA/G;AACA;AACA,YAAIjC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA;;AAEA;AACA;AACA,aAAI,IAAIf,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,sBAAUjC,CAAV,EAAaqB,KAAb,GAAqBwB,SAArB;AACA,gBAAIE,OAAOX,SAASpC,IAAIuC,UAAb,GAA0BN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAArD,GAAiE,GAAtG;AACA;AACA,gBAAIrB,QAAQS,UAAUjC,CAAV,EAAayB,YAAb,CAA0BnE,YAA1B,CAAZ;AACAkE,kBAAMgB,IAAN,CAAWY,SAAX,CAAqBzF,GAAGsF,MAAH,CAAU,GAAV,EAAcF,IAAd,EAAmBwF,MAAnB,CAArB;;AAEA,gBAAGvI,KAAGiC,UAAUhC,MAAV,GAAiB,CAAvB,EAAyB;AACrBuB,sBAAMK,YAAN,CAAmB,IAAnB;AACH;AACJ;AACJ,KA9iBI;;;AAgjBL;AACAG,uBAjjBK,iCAijBgB;;AAEjB,YAAIvC,iBAAiB,EAArB;AACA,YAAI+I,iBAAiB,CACjB,CADiB,EACf,CADe,EACb,CADa,EACX,CADW,EACT,CADS,EACP,CADO,EACL,CADK,EACH,CADG,EACD,CADC,EACC,CADD,EACG,CADH,EACK,CADL,EACO,EADP,EACU,EADV,EACa,EADb,EACgB,GADhB,EACoB,GADpB,EACwB,GADxB,EAC4B,GAD5B,EACgC,GADhC,CAArB;AAGA,YAAIC,iBAAiB,CACjB,CADiB,EACf,CADe,EACb,CADa,EACX,CADW,EACT,CADS,EACP,CADO,EACL,CADK,EACH,CADG,EACD,CADC,EACC,CADD,EACG,CADH,EACK,CADL,EACO,CADP,EACS,CADT,EACW,CADX,EACa,CADb,EACe,CADf,EACiB,CADjB,EACmB,QADnB,EAC4B,MAD5B,CAArB;AAGA,aAAI,IAAIzI,IAAI,CAAZ,EAAcA,IAAIwI,eAAevI,MAAjC,EAAwCD,GAAxC,EAA4C;AACxC,gBAAIE,gBAAgB;AAChBC,yBAAUqI,eAAexI,CAAf,CADM;AAEhBI,0BAAWqI,eAAezI,CAAf;AAFK,aAApB;AAIAP,2BAAeY,IAAf,CAAoBH,aAApB;AACH;AACDT,uBAAea,IAAf,CAAoB9C,SAAS+C,SAA7B;;AAEA,YAAIG,iBAAiB,EAArB;AACA,YAAIC,eAAe,EAAnB;AACA,YAAIC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA,YAAIC,QAAQ,KAAK1C,eAAjB;;AAEA,aAAI,IAAI0B,IAAI,CAAZ,EAAcA,IAAIP,eAAeQ,MAAjC,EAAwCD,GAAxC,EAA4C;AACxC,gBAAIkB,WAAWvD,GAAGwD,WAAH,CAAe,KAAKnD,SAApB,CAAf;AACAkD,qBAASE,MAAT,GAAkBJ,KAAlB;AACAE,qBAASG,KAAT,GAAiB9D,OAAOsC,OAAP,CAAeyF,KAAf,CAAqB/D,UAAtC;AACA,gBAAIC,QAAQN,SAASO,YAAT,CAAsBnE,YAAtB,CAAZ;AACAmC,2BAAeO,CAAf,EAAkB0B,QAAlB,GAA6B,KAA7B;AACAF,kBAAMG,SAAN,CAAgBlC,eAAeO,CAAf,CAAhB;AACAU,2BAAeL,IAAf,CAAoBa,QAApB;AACA,iBAAKwH,gBAAL,CAAsBhI,cAAtB,EAAqCnD,OAAOsC,OAAP,CAAeyF,KAApD,EAA0D1E,aAAW,CAArE,EAAwEA,aAAW,CAAX,GAAe,GAAvF;AACH;;AAEA;AACA,YAAI8F,QAAQ,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,EAAb,EAAgB,EAAhB,EAAmB,EAAnB,EAAsB,GAAtB,EAA0B,GAA1B,EAA8B,GAA9B,CAAZ,CAnCgB,CAmC+B;AAC/C;AACA,YAAI0B,QAAQ,CAAZ;AACA,aAAI,IAAIpI,IAAIP,eAAeQ,MAAf,GAAwB,CAApC,EAAuCD,IAAI,CAAC,CAA5C,EAA8CA,GAA9C,EAAkD;AAC9C,gBAAI8G,YAAYtJ,SAASuJ,cAAT,CAAwBtH,eAAeO,CAAf,EAAkBG,OAA1C,CAAhB;;AAEAR,oBAAQC,GAAR,CAAY,gBAAckH,SAAd,GAAwB,SAAxB,GAAkCsB,KAA9C;;AAEA,gBAAG1B,MAAM0B,KAAN,KAAc1B,MAAM0B,KAAN,KAActB,SAA/B,EAAyC;AAAE;AACvCnH,wBAAQC,GAAR,CAAY,YAAU8G,MAAM0B,KAAN,CAAtB;AACA,oBAAIT,iBAAiBjH,eAAeV,CAAf,CAArB;AACAW,6BAAaiH,OAAb,CAAqBD,cAArB;AACAlI,+BAAeoI,MAAf,CAAsB7H,CAAtB,EAAwB,CAAxB;AACAU,+BAAemH,MAAf,CAAsB7H,CAAtB,EAAwB,CAAxB;AACH;AACDoI;AACH;AACD;AACA;AACA,aAAKO,aAAL,CAAmBhI,YAAnB,EAAgC,GAAhC,EAAoC,GAApC;AACA,aAAK+H,gBAAL,CAAsBhI,cAAtB,EAAqCnD,OAAOsC,OAAP,CAAeyF,KAApD,EAA0D1E,aAAW,CAArE,EAAwEA,aAAW,CAAX,GAAe,GAAvF;AACA;AACD;AACA;AACA;AAEH,KA9mBI;AA+mBL8H,oBA/mBK,4BA+mBYzG,SA/mBZ,EA+mBsBC,YA/mBtB,EA+mBmCC,SA/mBnC,EA+mB6CC,MA/mB7C,EA+mBoD;AACrD,YAAGH,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAIoC,WAAWJ,UAAUhC,MAAzB;AACA,YAAIqC,YAAY,CAACD,WAAW,CAAZ,IAAiBH,aAAaK,UAA9B,GAA2CN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAA7H;AACAY,oBAAYA,aAAaxE,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAAlD;AACA,YAAI0B,YAAY,CAACN,YAAYG,SAAb,IAA0B,CAA1C;AACAF,iBAASA,UAAUK,SAAnB;;AAEAL,iBAASA,SAAS,KAAGF,aAAaK,UAAlC;;AAEA,YAAI+F,MAAMrG,UAAUhC,MAApB;AACA,YAAGqI,OAAK,EAAR,EAAW;AACPlG,qBAASA,SAAS,CAAC,KAAKkG,GAAN,IAAWpG,aAAaK,UAA1C;AACA,iBAAI,IAAIvC,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,0BAAUjC,CAAV,EAAa0C,WAAb,CAAyBN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAA/I,EAAmJW,aAAaS,SAAhK;AACH;AACJ,SALD,MAKK;AACD,iBAAI,IAAI3C,IAAI,CAAZ,EAAeA,IAAI,EAAnB,EAAuBA,GAAvB,EAA2B;AACvBiC,0BAAUjC,CAAV,EAAa0C,WAAb,CAAyBN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAA/I,EAAmJW,aAAaS,SAAhK;AACH;;AAED,iBAAI,IAAI3C,IAAE,CAAV,EAAYA,IAAEsI,MAAI,EAAlB,EAAqBtI,GAArB,EAAyB;AACrBiC,0BAAUjC,IAAE,EAAZ,EAAgB0C,WAAhB,CAA4BN,SAASpC,IAAIkC,aAAaK,UAA1B,GAAuCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqDmB,aAAaX,UAAlE,GAA+E,GAAlJ,EAAsJW,aAAaS,SAAb,GAAuB,EAA7K;AACH;AACJ;AACJ,KAxoBI;AA0oBLgG,iBA1oBK,yBA0oBS1G,SA1oBT,EA0oBmBG,MA1oBnB,EA0oB0BmG,MA1oB1B,EA0oBiC;AAClC,YAAGtG,UAAUhC,MAAV,GAAmB,CAAtB,EAAwB;AAAC;AAAO;AAChC,YAAI4C,YAAY,IAAhB;AACA,YAAIN,aAAa,EAAjB;AACA,YAAIO,gBAAgB,CAACb,UAAUhC,MAAV,GAAmB,CAApB,IAAyBsC,UAAzB,GAAsCN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAA/G;AACA;AACA,YAAIjC,aAAajD,GAAGkD,QAAH,CAAYC,UAAZ,GAAyBC,KAA1C;AACA;;AAEAqB,iBAASxB,aAAW,CAAX,GAAe,GAAf,GAAqB2B,aAAWN,UAAUhC,MAAnD;;AAEA;AACA;AACA,aAAI,IAAID,IAAI,CAAZ,EAAeA,IAAIiC,UAAUhC,MAA7B,EAAqCD,GAArC,EAAyC;AACrCiC,sBAAUjC,CAAV,EAAaqB,KAAb,GAAqBwB,SAArB;AACA,gBAAIE,OAAOX,SAASpC,IAAIuC,UAAb,GAA0BN,UAAU,CAAV,EAAaR,YAAb,CAA0BnE,YAA1B,EAAwCkF,IAAxC,CAA6CzB,KAA7C,GAAqD8B,SAArD,GAAiE,GAAtG;AACA;AACA,gBAAIrB,QAAQS,UAAUjC,CAAV,EAAayB,YAAb,CAA0BnE,YAA1B,CAAZ;AACAkE,kBAAMgB,IAAN,CAAWY,SAAX,CAAqBzF,GAAGsF,MAAH,CAAU,GAAV,EAAcF,IAAd,EAAmBwF,MAAnB,CAArB;;AAEA;AACA;AACA;AACH;AACJ,KAlqBI;;;AAoqBL;AACAK,gBArqBK,0BAqqBS;AACVjJ,gBAAQC,GAAR,CAAY,cAAZ;AACAjC,WAAGkD,QAAH,CAAYgI,SAAZ,CAAsB,WAAtB;AACH,KAxqBI;AAyqBLC,oBAzqBK,8BAyqBa;AACdnJ,gBAAQC,GAAR,CAAY,kBAAZ;AACAjC,WAAGoL,MAAH,CAAUC,OAAV,CAAkB,uBAAlB,EAA2C,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AAC9D,gBAAID,GAAJ,EAAS;AACLtJ,wBAAQC,GAAR,CAAYqJ,GAAZ;AACA;AACH;AACD,gBAAIE,UAAUxL,GAAGwD,WAAH,CAAe+H,MAAf,CAAd;AACAvL,eAAGkD,QAAH,CAAYI,QAAZ,GAAuBmI,QAAvB,CAAgCD,OAAhC;AACH,SAPD;AAQH,KAnrBI;AAorBLE,eAprBK,yBAorBQ;AACT1J,gBAAQC,GAAR,CAAY,aAAZ;AACC;AACAjC,WAAGoL,MAAH,CAAUC,OAAV,CAAkB,kBAAlB,EAAsC,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AAC1D,gBAAID,GAAJ,EAAS;AACLtJ,wBAAQC,GAAR,CAAYqJ,GAAZ;AACA;AACH;AACD,gBAAIE,UAAUxL,GAAGwD,WAAH,CAAe+H,MAAf,CAAd;AACAvL,eAAGkD,QAAH,CAAYI,QAAZ,GAAuBmI,QAAvB,CAAgCD,OAAhC;AACH,SAPA;AAQJ,KA/rBI;AAgsBLG,mBAhsBK,6BAgsBY;AACb3J,gBAAQC,GAAR,CAAY,iBAAZ;AACH,KAlsBI;AAmsBL2J,gBAnsBK,0BAmsBS;AACV5J,gBAAQC,GAAR,CAAY,cAAZ;AACH;AArsBI,CAAT","file":"GameTable.js","sourceRoot":"../../../../assets/Script","sourcesContent":["\r\nvar PokerData = require(\"PokerData\");\r\nvar PokerControl = require(\"PokerControl\");\r\nvar config = require(\"config\");\r\n\r\nvar CardUtil = require(\"CardUtil\")\r\nvar PopCardUtil = require(\"PopCardUtil\")\r\n\r\nvar opratOutCardControl = require(\"opratOutCardControl\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        pokerCard : {\r\n            default : null,\r\n            type : cc.Prefab\r\n        },\r\n\r\n        pokerLayerLeft:{\r\n            default : null,\r\n            type : cc.Node,\r\n        },\r\n        pokerLayerRight:{\r\n            default : null,\r\n            type : cc.Node,\r\n        },\r\n        pokerLayerMy:{\r\n            default : null,\r\n            type : cc.Node,\r\n        },\r\n\r\n        chupaiBtn : {\r\n            default : null,\r\n            type : cc.Node,\r\n        },\r\n\r\n        buchuBtn : {\r\n            default : null,\r\n            type : cc.Node\r\n        },\r\n        canvas:cc.Node, \r\n        opratOutCard:{\r\n            default : null,\r\n            type : cc.Prefab\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {\r\n        //初始化纸牌数据\r\n        PokerData.load();\r\n    },\r\n    start () {\r\n        var self = this;\r\n    \r\n        self.touchBeganX = 0;\r\n        self.leftX = 0;\r\n        self.rightX = 0;\r\n        self.upY = 0;\r\n        self.downY = 0;\r\n        self.isTouchbegan = false;\r\n        //得到第三份数据\r\n        var allPeoplePokerData = PokerData.getPartCardsData()\r\n        var leftPokerData = allPeoplePokerData[0];\r\n        var rightPokerData = allPeoplePokerData[1];\r\n        var myPokerData = allPeoplePokerData[2];\r\n        console.log(config.seatPos);\r\n\r\n        //xx_test\r\n        myPokerData = [];\r\n        var myCardValue = [\r\n            3,5,5,5,5,6,6,6,6,9,9,9,10,10,10,\"J\",\"J\",\"J\",\"Q\",\"K\"//g/G\r\n        ];\r\n        var myCardColor = [\r\n            1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4//\"smallG\",\"bigG\"\r\n        ]; \r\n        for(var i = 0;i < myCardValue.length;i++){\r\n            var pokerDataItem = {\r\n                showTxt : myCardValue[i],\r\n                showType : myCardColor[i]\r\n            }\r\n            myPokerData.push(pokerDataItem);\r\n        }\r\n        myPokerData.sort(CardUtil.gradeDown);\r\n\r\n\r\n        //-----\r\n        // var source = [3,3,3,5,6,7,7,7,9,9,10,10,11,11,12,12,12];\r\n        // var source = [];\r\n        // for(var i=0;i<myCardValue.length;i++){\r\n        //     source[i]=CardUtil.StringToNumber(myCardValue[i]);\r\n        // }\r\n        // console.log(\"sourcelength:\"+source.length);\r\n\r\n        // var sameValues = PopCardUtil.getSameCards(myCardValue);\r\n        // PopCardUtil.setSameVulueCardCount(sameValues);\r\n\r\n        // for(var k in sameValues){\r\n        //     var d = sameValues[k];\r\n        //     console.log(\"length_d:\"+d.length+\"  k:\"+k);\r\n        // }\r\n        //-----\r\n\r\n        \r\n\r\n       \r\n        var myPokerNode = [];\r\n        var leftPokerNode = [];\r\n        var rightPokerNode = [];\r\n        var dispatchCard = [];\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        //将预制节点放置在界面上\r\n        var scene = cc.director.getScene();\r\n        // var scene = this.pokerLayerMy;\r\n\r\n        console.log(\"sceneWidth:\"+sceneWidth);\r\n\r\n\r\n        for(var i = 0;i < myPokerData.length;i++){\r\n            var cardNode = cc.instantiate(this.pokerCard);\r\n            cardNode.parent = scene;\r\n            cardNode.scale = config.seatPos.center.pokerScale;\r\n            var poker = cardNode.getComponent(PokerControl);\r\n            myPokerData[i].canTouch = true;\r\n            poker.showPoker(myPokerData[i]);\r\n            myPokerNode.push(cardNode);\r\n            this.neatenPoker(myPokerNode,config.seatPos.center,sceneWidth);\r\n        }\r\n        //最后一张牌设置为地主牌\r\n        myPokerNode[myPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\r\n\r\n        // for(var i = 0;i < myPokerData.length;i++){ //myPokerData leftPokerData\r\n        //     var cardNode = cc.instantiate(this.pokerCard);\r\n        //     cardNode.parent = scene;\r\n        //     cardNode.scale = config.seatPos.left.pokerScale;\r\n        //     var poker = cardNode.getComponent(PokerControl);\r\n        //     myPokerData[i].canTouch = false;\r\n        //     poker.showPoker(myPokerData[i]);\r\n        //     leftPokerNode.push(cardNode);\r\n        //     this.neatenPoker(leftPokerNode,config.seatPos.left,sceneWidth/2, 230);\r\n        // }\r\n\r\n        // for(var i = 0;i < myPokerData.length;i++){ //myPokerData rightPokerData\r\n        //     var cardNode = cc.instantiate(this.pokerCard);\r\n        //     cardNode.parent = scene;\r\n        //     cardNode.scale = config.seatPos.right.pokerScale;\r\n        //     var poker = cardNode.getComponent(PokerControl);\r\n        //     myPokerData[i].canTouch = false;\r\n        //     poker.showPoker(myPokerData[i]);\r\n        //     rightPokerNode.push(cardNode);\r\n        //     this.neatenPoker(rightPokerNode,config.seatPos.right,sceneWidth/2, sceneWidth/2 + 140);\r\n        // }\r\n\r\n        this.myPokerData = myPokerData;\r\n        this.myPokerNode = myPokerNode;\r\n        this.dispatchCard = dispatchCard;\r\n\r\n        this.sceneWidth = sceneWidth;\r\n        this.scene = scene;\r\n        this.registerEvent();\r\n\r\n        this.playerLeftShowCard();\r\n        this.playerRightShowCard();\r\n    },\r\n    //理牌\r\n    neatenPoker(pokerNode,seatPosParam,showWidth,startX){\r\n        if(pokerNode.length < 1){return}\r\n        var pokerNum = pokerNode.length;\r\n        var needWidth = (pokerNum - 1) * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale;\r\n        // console.log(\"needWidth:\" + needWidth);\r\n        showWidth = showWidth || cc.director.getWinSize().width;\r\n        var startPosX = (showWidth - needWidth) / 2;\r\n        startX = startX || startPosX;\r\n        for(var i = 0; i < pokerNode.length; i++){\r\n            pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\r\n        }\r\n    },\r\n    //出牌\r\n    playCard(pokerNode){\r\n        if(pokerNode.length < 1){return}\r\n        var cardScale = 0.57\r\n        var disBetween = 40;\r\n        var showCardWidth = (pokerNode.length - 1) * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale;\r\n        // console.log(\"showCardWidth:\"+showCardWidth);\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        var startX = (sceneWidth - showCardWidth) / 2;\r\n        // console.log(\"startX:\"+startX);\r\n        //设置出去的牌的大小\r\n        for(var i = 0; i < pokerNode.length; i++){\r\n            pokerNode[i].scale = cardScale;\r\n            var posX = startX + i * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale * 0.5;\r\n            // console.log(\"posX:\"+posX);\r\n            var move = cc.moveTo(0.2,posX,500);\r\n            move.easing(cc.easeIn(2));\r\n            var poker = pokerNode[i].getComponent(PokerControl);\r\n            poker.node.runAction(move);\r\n\r\n            if(i==pokerNode.length-1){\r\n                poker.setCardDiZhu(true);\r\n            }\r\n        }\r\n    },\r\n    //注册触摸事件\r\n    registerEvent(){\r\n        var self = this;\r\n        var myPokerNode = this.myPokerNode;\r\n\r\n        this.canvas.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            // console.log(\"touchStart\");\r\n            if(myPokerNode.length < 1)\r\n            return false;\r\n            var p = event.getLocation();\r\n            // console.log(\">>x:\"+p.x+\">>y:\"+p.y);\r\n            self.touchBeganX = p.x;\r\n            self.leftX = 0;\r\n            self.rightX = 10000;\r\n            self.upY = 10000;\r\n            self.downY = 0;\r\n            self.isTouchbegan = true;\r\n            self.setSelectCardByTouch(myPokerNode,p.x,p.y,self.isTouchbegan);\r\n\r\n            if (self.isTouchbegan){\r\n                var x1 = myPokerNode[0].getPositionX();\r\n                var x2 = myPokerNode[myPokerNode.length-1].getPositionX();\r\n                var py = myPokerNode[0].getPositionY();\r\n                var psize = myPokerNode[0].getContentSize();\r\n                var pwidth = psize.width;\r\n                var pheight = psize.height;\r\n\r\n                var disBetween = 10;\r\n    \r\n                self.leftX = x1-pwidth/2-disBetween;\r\n                self.rightX = x2+pwidth/2+disBetween;\r\n                self.upY = py+pheight/2+40;\r\n                self.downY = py-pheight/2;\r\n\r\n                console.log(\"self.leftX:\"+self.leftX+\"  self.rightX:\"+self.rightX+\" self.downY:\"+self.downY+\"  self.upY:\"+ self.upY);\r\n                if (self.isTouchbegan && (p.y > self.upY || p.y < self.downY || p.x < self.leftX || p.x > self.rightX)){\r\n                    self.moveAllCardDown(myPokerNode);\r\n                }\r\n            }\r\n        }, this.node);\r\n        this.canvas.on(cc.Node.EventType.TOUCH_END,function(event){\r\n            // console.log(\"touchEnd\");\r\n            if(myPokerNode.length < 1)\r\n            return;\r\n            var p = event.getLocation();\r\n            self.moveCard(myPokerNode);\r\n        }, this.node);\r\n        this.canvas.on(cc.Node.EventType.TOUCH_MOVE,function(event){\r\n            if(myPokerNode.length < 1)\r\n            return;\r\n            var p = event.getLocation();\r\n            if (Math.abs(self.touchBeganX - p.x) > 40){\r\n                self.isTouchbegan = false;\r\n                self.setSelectCardByTouch(myPokerNode,p.x,p.y,self.isTouchbegan);\r\n            }\r\n        }, this.node);\r\n    },\r\n    //移除触摸事件\r\n    unregisterEvent(){\r\n        this.canvas.targetOff(this.node);\r\n        console.log(\"off\");\r\n    },\r\n    setSelectCardByTouch(myPokerNode,x,y,istouchbegan){\r\n        var touchStart = this.touchBeganX;\r\n        var touchEnd = x;\r\n        this.isTouchbegan = istouchbegan;\r\n\r\n        if (this.touchBeganX > x){\r\n            touchStart = x;\r\n            touchEnd = this.touchBeganX; \r\n        }\r\n        \r\n        //如果起点跟终点距离小于5 则处理成起点等于终点\r\n        if (touchEnd - touchStart<5){\r\n            touchEnd = touchStart;\r\n        }\r\n\r\n        var selected = false; //选中状态\r\n        \r\n        for(var i = 0;i < myPokerNode.length;i++){\r\n            var pokerNode = myPokerNode[i];\r\n            var posY = pokerNode.getPositionY();\r\n            var size = pokerNode.getContentSize();\r\n            var posX = pokerNode.getPositionX(); //+ size.width/2;\r\n\r\n            var width = size.width;\r\n            var height = size.height;\r\n\r\n            var disBetween = config.seatPos.center.disBetween;\r\n\r\n            var right = posX - width/2+disBetween;\r\n            var left =  posX - width/2;\r\n            var buttom = posY - height/2;\r\n            var up = posY + height/2;\r\n            //最后一张整张牌都可以点击\r\n            if(i == myPokerNode.length-1){\r\n                right = posX+width/2; \r\n            }\r\n            // console.log(\"left:\"+left+\"  right:\"+right+\" buttom:\"+buttom+\" up:\"+up);\r\n            // console.log(\"posX:\"+posX+\" posY:\"+posY+\" sizeW:\"+width+\" sizeH:\"+height);\r\n            if ( y >= buttom && y <= up &&\r\n                ((left>= touchStart && left <= touchEnd) || (right>= touchStart && right <= touchEnd) ||\r\n                (touchStart>= left && touchStart <= right) || (touchEnd>= left && touchEnd <= right))){\r\n                    pokerNode.getComponent(PokerControl).setChoosed(true);\r\n                }else{\r\n                    // pokerNode:clearSelection();\r\n             }\r\n        }   \r\n    },\r\n    moveCard(myPokerNode){\r\n        for(var i = 0;i < myPokerNode.length;i++){\r\n            var pokerNode = myPokerNode[i];\r\n            pokerNode.getComponent(PokerControl).cardMove();\r\n        }\r\n    },\r\n    moveAllCardDown(myPokerNode){\r\n        console.log(\"moveAllCardDown\");\r\n        for(var i = 0;i < myPokerNode.length;i++){\r\n            var pokerNode = myPokerNode[i];\r\n            pokerNode.getComponent(PokerControl).cardMoveDown();\r\n        }\r\n    },\r\n    onShow(){\r\n        console.log(\"onShow\");\r\n        this.onMyOutCard();\r\n    },\r\n    onHide(){\r\n        console.log(\"onHide\");\r\n        //智能提牌测试\r\n        var myPokerNode = this.myPokerNode;\r\n        var myPokerData = this.myPokerData;\r\n        var topcards = CardUtil.getMyTopCards(myPokerNode,PokerControl);\r\n        \r\n        var mycards = [];\r\n        for(var i = myPokerData.length - 1; i > -1;i--){\r\n            mycards.push(myPokerData[i].showTxt);\r\n            console.log(\"xx\"+myPokerData[i].showTxt);\r\n        } \r\n        \r\n        var autocards = CardUtil.getCardsFromTopCards(mycards,topcards);\r\n        if(autocards.length < 1){\r\n        }else{\r\n            this.moveAllCardDown(myPokerNode);//先放下在提起\r\n            CardUtil.AutoChooseLiftUpCard(myPokerNode,PokerControl,autocards);\r\n        } \r\n    },\r\n    //轮到自己出牌\r\n    onMyOutCard(){\r\n        var self = this;\r\n        var dispatchCard = this.dispatchCard;\r\n        var sceneWidth = this.sceneWidth;\r\n        // var scene = this.scene;\r\n        var scene = cc.director.getScene();\r\n\r\n        var myPokerNode = this.myPokerNode;\r\n        var myPokerData = this.myPokerData;\r\n\r\n        //牌桌上已经有了出牌，清除掉\r\n        if(dispatchCard.length > 0){\r\n            console.log(\"dispatchCard.length:\"+dispatchCard.length);\r\n            for(var i = 0; i < dispatchCard.length; i++){\r\n                dispatchCard[i].getComponent(PokerControl).node.removeFromParent();\r\n            }\r\n            dispatchCard = [];\r\n        }\r\n\r\n        var buchuFunc = function(){\r\n            self.moveAllCardDown(myPokerNode);\r\n        }\r\n        var tishiNum = 0;\r\n        var tishiFunc = function(){\r\n            // var cards = [\"3\",\"3\",\"3\",\"7\",\"7\"];\r\n            var cards = [5,5,5,6,6,6,7,7];//\"3\",\"3\",\"3\",\"3\"\r\n            var cardstype = CardUtil.get_topCard_type(cards);\r\n            var myCards = [];\r\n            console.log(cardstype);\r\n\r\n            for(var i = myPokerData.length - 1; i > -1;i--){\r\n                var cardValue = CardUtil.StringToNumber(myPokerData[i].showTxt);\r\n                myCards.push(cardValue); \r\n            }\r\n\r\n            var tishicards = CardUtil.get_cards_larger(cardstype,myCards);\r\n\r\n            if(tishicards.length == 0){\r\n                console.log(\"没有符合的牌型可供提示\");\r\n                return;\r\n            }\r\n\r\n            console.log(\"xxx:\"+tishicards.length);\r\n            console.log(tishicards);\r\n\r\n            cards = tishicards[tishiNum];\r\n\r\n        \r\n            if(tishiNum<tishicards.length-1){\r\n                tishiNum++;\r\n            }else{\r\n                tishiNum = 0;\r\n            }\r\n\r\n\r\n            this.node.stopAllActions();\r\n            var callFunc = cc.callFunc(function(){\r\n                CardUtil.AutoChooseLiftUpCard(myPokerNode,PokerControl,cards);\r\n            });\r\n            var delay = cc.delayTime(0.25);\r\n            this.node.runAction(cc.sequence(delay,callFunc));\r\n\r\n            self.moveAllCardDown(myPokerNode);\r\n        }\r\n        var chupaiFunc = function(){\r\n            console.log(\"点击了出牌\");\r\n            var topCards = [];\r\n            //获取提起的牌直\r\n            for(var i = myPokerData.length - 1; i > -1;i--){\r\n                if(myPokerData[i].isTopped){\r\n                    var cardValue = CardUtil.StringToNumber(myPokerData[i].showTxt);\r\n                    topCards.push(cardValue);\r\n                }\r\n            }\r\n\r\n            if(topCards.length>=1){\r\n                var popCardsType = CardUtil.get_topCard_type(topCards);\r\n                console.log(popCardsType);\r\n                if(popCardsType.type == 0){\r\n                    console.log(\"提起的牌不合法\");\r\n                    return -1;\r\n                }    \r\n            }else{\r\n                console.log(\"没有牌提起\");\r\n                return 0;\r\n            }\r\n\r\n            for(var i = myPokerData.length - 1; i > -1;i--){\r\n                    if(myPokerData[i].isTopped){ //myPokerData[i].isChoosed\r\n                    var isChoosedPoker = myPokerNode[i];\r\n                    dispatchCard.unshift(isChoosedPoker);\r\n                    myPokerData.splice(i,1);\r\n                    myPokerNode.splice(i,1);\r\n                }\r\n            }\r\n            self.dispatchCard = dispatchCard;\r\n            //出牌\r\n            self.playCard(dispatchCard);\r\n            self.neatenPoker(myPokerNode,config.seatPos.center,sceneWidth);\r\n            //最后一张牌设置为地主牌\r\n            if(myPokerNode.length>0){\r\n                myPokerNode[myPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\r\n            }\r\n        }\r\n        var opOutCard = cc.instantiate(this.opratOutCard);\r\n        // opOutCard.setPositionX(sceneWidth/2);\r\n        opOutCard.parent = scene;\r\n        var opOutCardControl = opOutCard.getComponent(opratOutCardControl);\r\n        opOutCardControl.show(20,buchuFunc,tishiFunc,chupaiFunc);\r\n    },\r\n    playerLeftShowCard(){\r\n        var leftPokerData = [];\r\n        var leftCardValue = [\r\n            3,5,5,5,5,6,6,6,6,9,9,9,10,10,10,\"J\",\"J\"//,\"J\",\"g\",\"G\"\r\n        ];\r\n        var leftCardColor = [\r\n            1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,\"smallG\",\"bigG\"\r\n        ]; \r\n        for(var i = 0;i < leftCardValue.length;i++){\r\n            var pokerDataItem = {\r\n                showTxt : leftCardValue[i],\r\n                showType : leftCardColor[i]\r\n            }\r\n            leftPokerData.push(pokerDataItem);\r\n        }\r\n        leftPokerData.sort(CardUtil.gradeDown);\r\n\r\n        var leftPokerNode = [];\r\n        var dispatchCard = [];\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        var scene = this.pokerLayerLeft;\r\n\r\n        for(var i = 0;i < leftPokerData.length;i++){\r\n            var cardNode = cc.instantiate(this.pokerCard);\r\n            cardNode.parent = scene;\r\n            cardNode.scale = config.seatPos.left.pokerScale;\r\n            var poker = cardNode.getComponent(PokerControl);\r\n            leftPokerData[i].canTouch = false;\r\n            poker.showPoker(leftPokerData[i]);\r\n            leftPokerNode.push(cardNode);\r\n            this.neatenLeftPoker(leftPokerNode,config.seatPos.left,sceneWidth/2, 230);\r\n        }\r\n        leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\r\n\r\n        //出牌\r\n        var cards = [3];//,5,5,5,5,6,6,6,6,9,9,9,10,10,10\r\n        // cards.sort(config.arrayDown);\r\n        var index = 0;\r\n        for(var i = leftPokerData.length - 1; i > -1;i--){\r\n            var cardValue = CardUtil.StringToNumber(leftPokerData[i].showTxt);\r\n            // var index = leftPokerData.length - 1 - i;\r\n            console.log(\"cardValue:\"+cardValue+\"index:\"+index);\r\n\r\n            if(cards[index]&&cards[index]==cardValue){ //myPokerData[i].isChoosed\r\n                console.log(\"cards:\"+cards[index]);\r\n                var isChoosedPoker = leftPokerNode[i];\r\n                dispatchCard.unshift(isChoosedPoker);\r\n                leftPokerData.splice(i,1);\r\n                leftPokerNode.splice(i,1);\r\n            }\r\n            index++;\r\n        }\r\n        // self.dispatchCard = dispatchCard;\r\n        //出牌\r\n        this.playCardLeft(dispatchCard,320,650);\r\n        this.neatenLeftPoker(leftPokerNode,config.seatPos.left,sceneWidth/2, 230);\r\n        //最后一张牌设置为地主牌\r\n        if(leftPokerNode.length>0){\r\n            leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\r\n        }\r\n\r\n    },\r\n    neatenLeftPoker(pokerNode,seatPosParam,showWidth,startX){\r\n        if(pokerNode.length < 1){return}\r\n        var pokerNum = pokerNode.length;\r\n        var needWidth = (pokerNum - 1) * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale;\r\n        showWidth = showWidth || cc.director.getWinSize().width;\r\n        var startPosX = (showWidth - needWidth) / 2;\r\n        startX = startX || startPosX;\r\n\r\n        var len = pokerNode.length;\r\n        if(len<=10){\r\n            for(var i = 0; i < pokerNode.length; i++){\r\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\r\n            }\r\n        }else{\r\n            for(var i = 0; i < 10; i++){\r\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\r\n            }\r\n\r\n            for(var i=0;i<len-10;i++){\r\n                pokerNode[i+10].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY-55);\r\n            }\r\n        }\r\n    },\r\n    //左边出牌\r\n    playCardLeft(pokerNode,startX,startY){\r\n        if(pokerNode.length < 1){return}\r\n        var cardScale = 0.38;\r\n        var disBetween = 27;\r\n        var showCardWidth = (pokerNode.length - 1) * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale;\r\n        // console.log(\"showCardWidth:\"+showCardWidth);\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        // var startX = (sceneWidth/2 - showCardWidth) / 2;\r\n\r\n        // console.log(\"startX:\"+startX);\r\n        //设置出去的牌的大小\r\n        for(var i = 0; i < pokerNode.length; i++){\r\n            pokerNode[i].scale = cardScale;\r\n            var posX = startX + i * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale * 0.5;\r\n            // console.log(\"posX:\"+posX);\r\n            var poker = pokerNode[i].getComponent(PokerControl);\r\n            poker.node.runAction(cc.moveTo(0.2,posX,startY));\r\n\r\n            if(i==pokerNode.length-1){\r\n                poker.setCardDiZhu(true);\r\n            }\r\n        }\r\n    },\r\n\r\n    //右边玩家明牌\r\n    playerRightShowCard(){\r\n\r\n        var rightPokerData = [];\r\n        var rightCardValue = [\r\n            3,5,5,5,5,6,6,6,6,9,9,9,10,10,10,\"J\",\"J\",\"J\",\"g\",\"G\"\r\n        ];\r\n        var rightCardColor = [\r\n            1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,\"smallG\",\"bigG\"\r\n        ]; \r\n        for(var i = 0;i < rightCardValue.length;i++){\r\n            var pokerDataItem = {\r\n                showTxt : rightCardValue[i],\r\n                showType : rightCardColor[i]\r\n            }\r\n            rightPokerData.push(pokerDataItem);\r\n        }\r\n        rightPokerData.sort(CardUtil.gradeDown);\r\n\r\n        var rightPokerNode = [];\r\n        var dispatchCard = [];\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        var scene = this.pokerLayerRight;\r\n\r\n        for(var i = 0;i < rightPokerData.length;i++){\r\n            var cardNode = cc.instantiate(this.pokerCard);\r\n            cardNode.parent = scene;\r\n            cardNode.scale = config.seatPos.right.pokerScale;\r\n            var poker = cardNode.getComponent(PokerControl);\r\n            rightPokerData[i].canTouch = false;\r\n            poker.showPoker(rightPokerData[i]);\r\n            rightPokerNode.push(cardNode);\r\n            this.neatenRightPoker(rightPokerNode,config.seatPos.right,sceneWidth/2, sceneWidth/2 + 140);\r\n        }\r\n\r\n         //出牌\r\n         var cards = [6,6,6,9,9,9,10,10,10,\"J\",\"J\",\"J\"];//,5,5,5,5,6,6,6,6\r\n         // cards.sort(config.arrayDown);\r\n         var index = 0;\r\n         for(var i = rightPokerData.length - 1; i > -1;i--){\r\n             var cardValue = CardUtil.StringToNumber(rightPokerData[i].showTxt);\r\n\r\n             console.log(\"cardValueB:\"+cardValue+\"indexB:\"+index);\r\n        \r\n             if(cards[index]&&cards[index]==cardValue){ //myPokerData[i].isChoosed\r\n                 console.log(\"cardsB:\"+cards[index]);\r\n                 var isChoosedPoker = rightPokerNode[i];\r\n                 dispatchCard.unshift(isChoosedPoker);\r\n                 rightPokerData.splice(i,1);\r\n                 rightPokerNode.splice(i,1);\r\n             }\r\n             index++;\r\n         }\r\n         // self.dispatchCard = dispatchCard;\r\n         //出牌\r\n         this.playCardRight(dispatchCard,620,650);\r\n         this.neatenRightPoker(rightPokerNode,config.seatPos.right,sceneWidth/2, sceneWidth/2 + 140);\r\n         //最后一张牌设置为地主牌\r\n        //  if(leftPokerNode.length>0){\r\n        //      leftPokerNode[leftPokerNode.length-1].getComponent(PokerControl).setCardDiZhu(true);\r\n        //  }\r\n\r\n    },\r\n    neatenRightPoker(pokerNode,seatPosParam,showWidth,startX){\r\n        if(pokerNode.length < 1){return}\r\n        var pokerNum = pokerNode.length;\r\n        var needWidth = (pokerNum - 1) * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale;\r\n        showWidth = showWidth || cc.director.getWinSize().width;\r\n        var startPosX = (showWidth - needWidth) / 2;\r\n        startX = startX || startPosX;\r\n\r\n        startX = startX + 10*seatPosParam.disBetween;\r\n\r\n        var len = pokerNode.length;\r\n        if(len<=10){\r\n            startX = startX + (10 - len)*seatPosParam.disBetween;\r\n            for(var i = 0; i < pokerNode.length; i++){\r\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\r\n            }\r\n        }else{\r\n            for(var i = 0; i < 10; i++){\r\n                pokerNode[i].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY);\r\n            }\r\n\r\n            for(var i=0;i<len-10;i++){\r\n                pokerNode[i+10].setPosition(startX + i * seatPosParam.disBetween + pokerNode[0].getComponent(PokerControl).node.width * seatPosParam.pokerScale * 0.5,seatPosParam.positionY-55);\r\n            }\r\n        }\r\n    },\r\n\r\n    playCardRight(pokerNode,startX,startY){\r\n        if(pokerNode.length < 1){return}\r\n        var cardScale = 0.38;\r\n        var disBetween = 27;\r\n        var showCardWidth = (pokerNode.length - 1) * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale;\r\n        // console.log(\"showCardWidth:\"+showCardWidth);\r\n        var sceneWidth = cc.director.getWinSize().width;\r\n        // var startX = (sceneWidth/2 - showCardWidth) / 2;\r\n\r\n        startX = sceneWidth/2 + 590 - disBetween*pokerNode.length;\r\n\r\n        // console.log(\"startX:\"+startX);\r\n        //设置出去的牌的大小\r\n        for(var i = 0; i < pokerNode.length; i++){\r\n            pokerNode[i].scale = cardScale;\r\n            var posX = startX + i * disBetween + pokerNode[0].getComponent(PokerControl).node.width * cardScale * 0.5;\r\n            // console.log(\"posX:\"+posX);\r\n            var poker = pokerNode[i].getComponent(PokerControl);\r\n            poker.node.runAction(cc.moveTo(0.2,posX,startY));\r\n\r\n            // if(i==pokerNode.length-1){\r\n            //     poker.setCardDiZhu(true);\r\n            // }\r\n        }\r\n    },\r\n\r\n    //按钮点击事件\r\n    btnBackClick(){\r\n        console.log(\"btnBackClick\");\r\n        cc.director.loadScene(\"HallScene\");\r\n    },\r\n    btnDelegateClick(){\r\n        console.log(\"btnDelegateClick\");\r\n        cc.loader.loadRes(\"prefab/CancelDelegate\", function (err, prefab) {\r\n            if (err) {\r\n                console.log(err);\r\n                return;\r\n            }\r\n            var newNode = cc.instantiate(prefab);\r\n            cc.director.getScene().addChild(newNode);\r\n        });\r\n    },\r\n    btnSetClick(){\r\n        console.log(\"btnSetClick\");\r\n         // 加载 Prefab\r\n         cc.loader.loadRes(\"prefab/setDialog\", function (err, prefab) {\r\n            if (err) {\r\n                console.log(err);\r\n                return;\r\n            }\r\n            var newNode = cc.instantiate(prefab);\r\n            cc.director.getScene().addChild(newNode);\r\n        });\r\n    },\r\n    btnJiPaiQiClick(){\r\n        console.log(\"btnJiPaiQiClick\");\r\n    },\r\n    btnChatClick(){\r\n        console.log(\"btnChatClick\");\r\n    }\r\n});\r\n"]}