{"version":3,"sources":["../../../../assets/Script/assets/Script/HallLayerControl.js"],"names":["dialogManager","require","PlayerDetailModel","EventHelper","config","GameNetMgr","Events","cc","Class","extends","Component","properties","taskTip","default","type","Sprite","mailTip","shareTip","start","self","enabled","getTaskUnReward","getMailUnread","getShareUnReward","AddCustomEvent","MyNode","onRefreshDataResult","continueRoomId","callFunc","arg","roomId","sendRequest","delay","delayTime","node","runAction","sequence","Network","LoginRoomResult","onLoginRoomResult","onDestroy","console","log","event","data","getUserData","handleLoginRoomResult","preloadNextScene","RemoveCustomEvent","director","preloadScene","loadScene","payload","mail_unread","weichatgame_task_unaward","weichatgame_invite_unaward","btnSetClick","showSetDialog","vv","audioMgr","playSFX","btnTaskClick","showTaskDialog","btnEmailClick","showEmailDialog","btnBagClick","showBagDialog","btnShopClick","btnShareClick","showShareDialog","args","parseInt","m_sended","m_totalTimes","m_curTimes","sended","totalTimes","curTimes","tableInfo","IsContinueGaming"],"mappings":"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","file":"HallLayerControl.js","sourceRoot":"../../../../assets/Script","sourcesContent":["\nvar dialogManager = require(\"dialogManager\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar EventHelper = require(\"EventHelper\");\nvar config = require(\"config\");\nvar GameNetMgr = require(\"GameNetMgr\");\nvar Events = require(\"Events\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        taskTip : {\n            default : null,\n            type : cc.Sprite\n        },\n        mailTip : {\n            default : null,\n            type : cc.Sprite\n        },\n        shareTip : {\n            default : null,\n            type : cc.Sprite\n        },\n    },\n    // onLoad () {},\n    start () {\n        var self = this;\n        this.taskTip.enabled = false;\n        this.mailTip.enabled = false;\n        this.shareTip.enabled = false;\n\n        if(PlayerDetailModel.getTaskUnReward()>0){\n            this.taskTip.enabled = true;\n        }\n        if(PlayerDetailModel.getMailUnread()>0){\n            this.mailTip.enabled = true;\n        }\n        if(PlayerDetailModel.getShareUnReward()>0){\n            this.shareTip.enabled = true;\n        }\n\n        EventHelper.AddCustomEvent(config.MyNode,\"RefreshDataResult\",self.onRefreshDataResult,self);\n\n        if(PlayerDetailModel.continueRoomId != 0){\n            var callFunc = cc.callFunc(function(){\n                var arg = {};\n                arg.roomId = PlayerDetailModel.continueRoomId;\n                GameNetMgr.sendRequest(\"Game\", \"loginRoom\", arg);\n                // self.preloadNextScene();\n             });\n             var delay = cc.delayTime(0.5);\n             this.node.runAction(cc.sequence(delay,callFunc));\n             EventHelper.AddCustomEvent(config.MyNode,Events.Network.LoginRoomResult,self.onLoginRoomResult,self);\n        }\n    },\n    onDestroy(){\n        console.log(\" HallLayer Destroy\");\n    },\n    onLoginRoomResult(event){\n        var self = this;\n        console.log(\"登陆房间回掉---\");\n        var data = event.getUserData();\n        // console.log(data);\n        self.handleLoginRoomResult(data); \n    },\n    preloadNextScene(){\n        var self = this;\n        EventHelper.RemoveCustomEvent(config.MyNode,Events.Network.LoginRoomResult,self.onLoginRoomResult,self);\n        // EventHelper.RemoveCustomEvent(config.MyNode,\"OpenRechargeTipResult\",self.onOpenRechargeTipResult,self);\n        cc.director.preloadScene(\"GameScene\", function () {\n            cc.log(\"Next scene preloaded\");\n            cc.director.loadScene(\"GameScene\");\n        });\n    },\n    onRefreshDataResult(event){\n        var payload = event.getUserData();\n        console.log(\"onRefreshDataResult  33333\")\n        //未读邮件数\n        if (payload.data){\n            if(payload.data.mail_unread>0){\n                this.mailTip.enabled = true;\n            }else{\n                this.mailTip.enabled = false;\n            }\n        }\n        //未领取任务数\n        if (payload.data){\n            if(payload.data.weichatgame_task_unaward>0){\n                this.taskTip.enabled = true;\n            }else{\n                this.taskTip.enabled = false;\n            }\n        }\n        //未领取分享数\n        if (payload.data){\n            if(payload.data.weichatgame_invite_unaward>0){\n                this.shareTip.enabled = true;\n            }else{\n                this.shareTip.enabled = false;\n            }\n        }\n    },\n    btnSetClick(){\n        console.log(\"btnSetClick\");\n        dialogManager.showSetDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnTaskClick(){\n        console.log(\"btnTaskClick\");\n        dialogManager.showTaskDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnEmailClick(){\n        console.log(\"btnEmailClick\");\n        dialogManager.showEmailDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnBagClick(){\n        console.log(\"btnBagClick\");\n        dialogManager.showBagDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnShopClick(){\n        console.log(\"btnShopClick\");\n        // dialogManager.showShopDialog();\n    },\n    btnShareClick(){\n        console.log(\"btnShareClick\");\n        dialogManager.showShareDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    handleLoginRoomResult(event){\n        console.log(\"--进入上局未完的普通牌桌>>>\");\n        var payload = event.payload;\n        var args = {};\n        args[\"baseCoins\"] = payload[\"data\"][\"baseCoins\"];\n        args[\"rate\"] = payload[\"data\"][\"rate\"];\n        args[\"limitCoins\"] = payload[\"data\"][\"limitCoins\"];\n        args[\"rake\"] = payload[\"data\"][\"rake\"];\n        args[\"roomId\"] = payload[\"data\"][\"roomId\"];\n        args[\"rateMax\"] = payload[\"data\"][\"rateMax\"];\n        args[\"enterLimit\"] = payload[\"data\"][\"enterLimit\"];\n        args[\"emoticon\"] = payload[\"data\"][\"emoticon\"];\n        args[\"emoticon_items\"] = payload[\"data\"][\"emoticon_items\"];\n        args[\"advert\"] = payload[\"data\"][\"advert\"]; //记牌器数据\n\n        if(payload[\"data\"][\"modelId\"]){\n            args[\"modelId\"] = payload[\"data\"][\"modelId\"];\n        }\n        args[\"buys\"] = payload[\"data\"][\"buys\"];\n        args[\"givecoins\"] = null;\n\n        if(payload[\"data\"][\"isContinue\"] && parseInt(payload[\"data\"][\"isContinue\"]) == 1){\n            args[\"isContinueGaming\"] = true\n        } \n        var m_sended = payload[\"data\"][\"sendCoins\"];\n        var m_totalTimes = payload[\"data\"][\"sendCoinsTimes\"];\n        var m_curTimes = payload[\"data\"][\"sendCoinsTimesToday\"];\n\n        if(m_sended && m_sended > 0){\n            args[\"givecoins\"] = {\n                sended : m_sended,\n                totalTimes : m_totalTimes,\n                curTimes : m_curTimes,\n            };\n            //刷新用户乐豆乐券\n            console.log(\"刷新用户乐豆乐券\");\n        }\n        config.tableInfo = args;\n\n        console.log(config.tableInfo);\n\n        config.IsContinueGaming = 1;\n        this.preloadNextScene();\n    }\n});\n"]}