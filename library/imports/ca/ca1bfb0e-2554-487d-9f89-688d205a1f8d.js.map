{"version":3,"sources":["../../../../assets/Script/assets/Script/HallLayerControl.js"],"names":["dialogManager","require","PlayerDetailModel","EventHelper","config","GameNetMgr","Events","cc","Class","extends","Component","properties","taskTip","default","type","Sprite","mailTip","shareTip","btn_videoAd","ad_time","Label","start","self","enabled","string","timeCount","adCanTouch","getTaskUnReward","getMailUnread","getShareUnReward","AddCustomEvent","MyNode","onRefreshDataResult","onWatchAdvertisementResult","continueRoomId","callFunc","arg","roomId","sendRequest","delay","delayTime","node","runAction","sequence","Network","LoginRoomResult","onLoginRoomResult","firstLogin","showShareDialog","initWxVideoAd","showAd","wx","rewardedVideoAd","createRewardedVideoAd","adUnitId","onLoad","console","log","onError","err","onClose","res","isEnded","undefined","color","Color","vv","audioMgr","playBGM","adCdTime","schedule","showTimes","time","times","fen","Math","floor","miao","strfen","strmiao","onDestroy","event","data","getUserData","handleLoginRoomResult","preloadNextScene","RemoveCustomEvent","director","preloadScene","loadScene","payload","mail_unread","weichatgame_task_unaward","weichatgame_invite_unaward","btnSetClick","showSetDialog","playSFX","btnTaskClick","showTaskDialog","btnEmailClick","showEmailDialog","btnBagClick","showBagDialog","btnShopClick","btnShareClick","btnVideoAdClick","show","then","stopMusic","args","parseInt","m_sended","m_totalTimes","m_curTimes","sended","totalTimes","curTimes","tableInfo","IsContinueGaming","response","award","list","coins","arg1","arg2","push","coupon","noteCards","length","showAnimGetProp","watch_advertisement_cd"],"mappings":"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","file":"HallLayerControl.js","sourceRoot":"../../../../assets/Script","sourcesContent":["\nvar dialogManager = require(\"dialogManager\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar EventHelper = require(\"EventHelper\");\nvar config = require(\"config\");\nvar GameNetMgr = require(\"GameNetMgr\");\nvar Events = require(\"Events\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        taskTip : {\n            default : null,\n            type : cc.Sprite\n        },\n        mailTip : {\n            default : null,\n            type : cc.Sprite\n        },\n        shareTip : {\n            default : null,\n            type : cc.Sprite\n        },\n        btn_videoAd : {\n            default : null,\n            type : cc.Sprite\n        },\n        ad_time : {\n            default : null,\n            type : cc.Label\n        },\n    },\n    // onLoad () {},\n    start () {\n        var self = this;\n        this.taskTip.enabled = false;\n        this.mailTip.enabled = false;\n        this.shareTip.enabled = false;\n        this.ad_time.string = \"\";\n        this.timeCount = 0;\n        this.adCanTouch = true;\n        this.btn_videoAd.enabled = false;\n\n        if(PlayerDetailModel.getTaskUnReward()>0){\n            this.taskTip.enabled = true;\n        }\n        if(PlayerDetailModel.getMailUnread()>0){\n            this.mailTip.enabled = true;\n        }\n        if(PlayerDetailModel.getShareUnReward()>0){\n            this.shareTip.enabled = true;\n        }\n\n        EventHelper.AddCustomEvent(config.MyNode,\"RefreshDataResult\",self.onRefreshDataResult,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"WatchAdvertisementResult\",self.onWatchAdvertisementResult,self);\n\n        if(PlayerDetailModel.continueRoomId != 0){\n            var callFunc = cc.callFunc(function(){\n                var arg = {};\n                arg.roomId = PlayerDetailModel.continueRoomId;\n                GameNetMgr.sendRequest(\"Game\", \"loginRoom\", arg);\n                // self.preloadNextScene();\n             });\n             var delay = cc.delayTime(0.5);\n             this.node.runAction(cc.sequence(delay,callFunc));\n             EventHelper.AddCustomEvent(config.MyNode,Events.Network.LoginRoomResult,self.onLoginRoomResult,self);\n        }\n\n        //第一次登陆弹出分享窗口\n        if(config.firstLogin){\n            config.firstLogin = false;\n            dialogManager.showShareDialog();\n        }\n\n        //微信视频广告\n        this.initWxVideoAd();\n    },\n    initWxVideoAd(){\n        var self = this;\n        if(config.showAd == 1){\n            this.btn_videoAd.enabled = true;\n        }else{\n            return;\n        }\n        if(typeof(wx)==\"undefined\"){\n            return;\n        }\n        var rewardedVideoAd = wx.createRewardedVideoAd({ adUnitId: 'adunit-5e51a762e521fda5' })\n        rewardedVideoAd.onLoad(() => {\n            console.log('激励视频 广告加载成功')\n        })\n        rewardedVideoAd.onError(err => {\n            console.log(\"激励视频 拉取失败\"+err)\n        })\n        rewardedVideoAd.onClose(res => {\n            if (res && res.isEnded || res === undefined) {\n                console.log(\"正常播放结束，可以下发游戏奖励\")\n                GameNetMgr.sendRequest(\"System\", \"WatchAdvertisement\");\n                // self.timeCount = 60;\n                self.btn_videoAd.node.color = new cc.Color(218, 218, 218);\n                self.adCanTouch = false;\n            }\n            else {\n                console.log(\"播放中途退出，不下发游戏奖励\")\n            }\n            cc.vv.audioMgr.playBGM(\"MusicEx_Welcome\");\n        })\n        this.rewardedVideoAd = rewardedVideoAd;\n\n        if(config.adCdTime>1){\n            self.btn_videoAd.node.color = new cc.Color(218, 218, 218);\n            self.adCanTouch = false;\n        }\n\n        //计时器\n        this.timeCount = config.adCdTime;\n        this.schedule(function() {\n            if(this.timeCount > 0){\n                this.timeCount -= 1;\n                this.ad_time.string = this.showTimes(this.timeCount); \n                if(this.timeCount == 0){\n                    this.ad_time.string = \"\";\n                    this.btn_videoAd.node.color = new cc.Color(255, 255, 255);\n                    this.adCanTouch = true;\n                }\n            }\n        }, 1);\n    },\n    showTimes(time){\n        //秒转换分钟格式 2:00 == 120\n        var times = \"00:00\";\n        var fen = Math.floor(time/60);\n        var miao = time - fen*60; \n        var strfen = \"00\";\n        var strmiao = \"00\";\n        if(fen == 0){\n            strfen = \"00\";\n        }else if(fen < 10){\n            strfen = \"0\"+fen;\n        }else{\n            strfen = \"\"+fen;\n        }\n        if(miao == 0){\n            strmiao = \"00\";\n        }else if(miao < 10){\n            strmiao = \"0\"+miao;\n        }else{\n            strmiao = \"\"+miao;\n        }\n        times = strfen+\":\"+strmiao;\n        return times;\n    },\n    onDestroy(){\n        console.log(\" HallLayer Destroy\");\n    },\n    onLoginRoomResult(event){\n        var self = this;\n        console.log(\"登陆房间回掉---\");\n        var data = event.getUserData();\n        // console.log(data);\n        self.handleLoginRoomResult(data); \n    },\n    preloadNextScene(){\n        var self = this;\n        EventHelper.RemoveCustomEvent(config.MyNode,Events.Network.LoginRoomResult,self.onLoginRoomResult,self);\n        // EventHelper.RemoveCustomEvent(config.MyNode,\"OpenRechargeTipResult\",self.onOpenRechargeTipResult,self);\n        cc.director.preloadScene(\"GameScene\", function () {\n            cc.log(\"Next scene preloaded\");\n            cc.director.loadScene(\"GameScene\");\n        });\n    },\n    onRefreshDataResult(event){\n        var payload = event.getUserData();\n        console.log(\"onRefreshDataResult  33333\")\n        //未读邮件数\n        if (payload.data){\n            if(payload.data.mail_unread>0){\n                this.mailTip.enabled = true;\n            }else{\n                this.mailTip.enabled = false;\n            }\n        }\n        //未领取任务数\n        if (payload.data){\n            if(payload.data.weichatgame_task_unaward>0){\n                this.taskTip.enabled = true;\n            }else{\n                this.taskTip.enabled = false;\n            }\n        }\n        //未领取分享数\n        if (payload.data){\n            if(payload.data.weichatgame_invite_unaward>0){\n                this.shareTip.enabled = true;\n            }else{\n                this.shareTip.enabled = false;\n            }\n        }\n    },\n    btnSetClick(){\n        console.log(\"btnSetClick\");\n        dialogManager.showSetDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnTaskClick(){\n        console.log(\"btnTaskClick\");\n        dialogManager.showTaskDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnEmailClick(){\n        console.log(\"btnEmailClick\");\n        dialogManager.showEmailDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnBagClick(){\n        console.log(\"btnBagClick\");\n        dialogManager.showBagDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnShopClick(){\n        console.log(\"btnShopClick\");\n        // dialogManager.showShopDialog();\n    },\n    btnShareClick(){\n        console.log(\"btnShareClick\");\n        dialogManager.showShareDialog();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnVideoAdClick(){\n        console.log(\"btnVideoAdClick\");\n        if(!this.adCanTouch){\n            console.log(\"cd中。。。。。。。。\")\n            return;\n        }\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        if(typeof(wx)==\"undefined\"){\n            return;\n        }\n        if(this.rewardedVideoAd)\n            this.rewardedVideoAd.show().then(() => cc.vv.audioMgr.stopMusic());\n    },\n    handleLoginRoomResult(event){\n        console.log(\"--进入上局未完的普通牌桌>>>\");\n        var payload = event.payload;\n        var args = {};\n        args[\"baseCoins\"] = payload[\"data\"][\"baseCoins\"];\n        args[\"rate\"] = payload[\"data\"][\"rate\"];\n        args[\"limitCoins\"] = payload[\"data\"][\"limitCoins\"];\n        args[\"rake\"] = payload[\"data\"][\"rake\"];\n        args[\"roomId\"] = payload[\"data\"][\"roomId\"];\n        args[\"rateMax\"] = payload[\"data\"][\"rateMax\"];\n        args[\"enterLimit\"] = payload[\"data\"][\"enterLimit\"];\n        args[\"emoticon\"] = payload[\"data\"][\"emoticon\"];\n        args[\"emoticon_items\"] = payload[\"data\"][\"emoticon_items\"];\n        args[\"advert\"] = payload[\"data\"][\"advert\"]; //记牌器数据\n\n        if(payload[\"data\"][\"modelId\"]){\n            args[\"modelId\"] = payload[\"data\"][\"modelId\"];\n        }\n        args[\"buys\"] = payload[\"data\"][\"buys\"];\n        args[\"givecoins\"] = null;\n\n        if(payload[\"data\"][\"isContinue\"] && parseInt(payload[\"data\"][\"isContinue\"]) == 1){\n            args[\"isContinueGaming\"] = true\n        } \n        var m_sended = payload[\"data\"][\"sendCoins\"];\n        var m_totalTimes = payload[\"data\"][\"sendCoinsTimes\"];\n        var m_curTimes = payload[\"data\"][\"sendCoinsTimesToday\"];\n\n        if(m_sended && m_sended > 0){\n            args[\"givecoins\"] = {\n                sended : m_sended,\n                totalTimes : m_totalTimes,\n                curTimes : m_curTimes,\n            };\n            //刷新用户乐豆乐券\n            console.log(\"刷新用户乐豆乐券\");\n        }\n        config.tableInfo = args;\n\n        console.log(config.tableInfo);\n\n        config.IsContinueGaming = 1;\n        this.preloadNextScene();\n    },\n    onWatchAdvertisementResult(event){\n        console.log(\"-----看完广告领奖\");\n        var response = event.getUserData();\n        var award = response.data;\n        var list = [];\n        if(award.coins){\n            var args = {\n                arg1:\"ledou\",\n                arg2:award.coins,\n            }\n            list.push(args);\n        } \n        if(award.coupon){\n            var args = {\n                arg1:\"lequan\",\n                arg2:award.coupon,\n            }\n            list.push(args);\n        } \n        if(award.noteCards){\n            var args = {\n                arg1:\"jipaiqi\",\n                arg2:award.coupon,\n            }\n            list.push(args);\n        } \n        if(list.length>0){\n            dialogManager.showAnimGetProp(list);\n        }\n        config.adCdTime = award.watch_advertisement_cd;\n        this.timeCount = config.adCdTime;\n    }\n});\n"]}