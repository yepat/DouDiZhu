{"version":3,"sources":["../../../../../assets/Script/dialog/assets/Script/dialog/playerInfoControl.js"],"names":["config","require","PlayerDetailModel","GameNetMgr","cc","Class","extends","Component","properties","head","default","type","Sprite","ledou","Label","lequan","nickname","id","duijv","shenglv","expressionNode","Node","nodeLequan","onLoad","active","args","canClick","start","showMyInfo","string","getCoin","getCoupon","getNickName","getUid","Matches","getMatches","win","getWin","rate","Math","ceil","setHeadUrl","initInfo","posName","player","getNickname","getPlay","show","closeClick","console","log","vv","audioMgr","playSFX","node","destroy","self","imgUrl","getWechatImg","headUrl","getGender","loader","loadRes","SpriteFrame","err","spriteFrame","getComponent","load","texture","btn1Click","expressionId","emoticonType","tableInfo","emoticon_items","data","sendSeatId","receiveSeatId","sendRequest","btn2Click","btn3Click","btn4Click"],"mappings":"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","file":"playerInfoControl.js","sourceRoot":"../../../../../assets/Script/dialog","sourcesContent":["var config = require(\"config\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar GameNetMgr = require(\"GameNetMgr\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        head : {\n            default : null,\n            type : cc.Sprite\n        },\n        ledou : {\n            default : null,\n            type : cc.Label\n        },\n        lequan : {\n            default : null,\n            type : cc.Label\n        },\n        nickname : {\n            default : null,\n            type : cc.Label\n        },\n        id : {\n            default : null,\n            type : cc.Label\n        },\n        duijv : {\n            default : null,\n            type : cc.Label\n        },\n        shenglv : {\n            default : null,\n            type : cc.Label\n        },\n        expressionNode : {\n            default : null,\n            type : cc.Node\n        },\n        nodeLequan : {\n            default : null,\n            type : cc.Node\n        },\n\n    },\n    onLoad () {\n        this.expressionNode.active = false;\n        this.args={};\n\n        this.canClick = true;\n    },\n    start () {\n    },\n    showMyInfo(){\n        this.expressionNode.active = true;\n        this.canClick = false;\n        this.ledou.string = \"\"+PlayerDetailModel.getCoin();\n        this.lequan.string = \"\"+PlayerDetailModel.getCoupon();\n        this.nickname.string = \"\"+PlayerDetailModel.getNickName();\n        this.id.string = \"(ID:\"+ PlayerDetailModel.getUid()+\")\";\n        \n        var Matches = PlayerDetailModel.getMatches();\n        var win = PlayerDetailModel.getWin();\n        var rate = 0;\n        if (PlayerDetailModel.getMatches() == 0){\n            rate = 0\n        }else{\n            rate = Math.ceil(win / Matches * 100);\n        }\n\n        this.duijv.string = \"对局：\"+Matches;\n        this.shenglv.string = \"胜率：\"+rate+\"%\";\n        this.setHeadUrl();\n    },\n    initInfo(args){\n        if(args == \"hall\"){\n            this.showMyInfo();\n            return;\n        }\n        this.args = args;\n        if(args.posName == \"my\"){\n            this.expressionNode.active = false;\n            this.nodeLequan.active = true;\n        }else{\n            this.expressionNode.active = true;\n            this.nodeLequan.active = false;\n            // if(!args.player)\n            //     return;\n            // this.ledou.string = \"\"+args.player.getCoin();\n            // // this.lequan.string = \"\"+args.player.getLeQuan();\n            // this.nickname.string = \"\"+args.player.getNickname();\n            // this.id.string = \"(ID:\"+ args.player.getUid()+\")\";\n\n            // var Matches = args.player.getPlay();\n            // var win = args.player.getWin();\n            // var rate = 0;\n            // if (Matches == 0){\n            //     rate = 0\n            // }else{\n            //     rate = Math.ceil(win / Matches * 100);\n            // }\n            // this.duijv.string = \"对局：\"+Matches;\n            // this.shenglv.string = \"胜率：\"+rate+\"%\";\n            // this.setHeadUrl(args.player.getWechatImg());\n        }\n        if(!args.player)\n                return;\n        this.ledou.string = \"\"+args.player.getCoin();\n        // this.lequan.string = \"\"+args.player.getLeQuan();\n        this.nickname.string = \"\"+args.player.getNickname();\n        this.id.string = \"(ID:\"+ args.player.getUid()+\")\";\n\n        var Matches = args.player.getPlay();\n        var win = args.player.getWin();\n        var rate = 0;\n        if (Matches == 0){\n            rate = 0\n        }else{\n            rate = Math.ceil(win / Matches * 100);\n        }\n        this.duijv.string = \"对局：\"+Matches;\n        this.shenglv.string = \"胜率：\"+rate+\"%\";\n        this.setHeadUrl(args.player);\n    },   \n    show(args){\n        // console.log(args);\n        this.initInfo(args);\n    },\n    closeClick(){\n        console.log(\"close click\");\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        this.node.destroy();\n    },\n    setHeadUrl(player){\n        var self = this;\n         //设置微信头像\n         var imgUrl=\"\";\n         if(player){\n            imgUrl=player.getWechatImg();\n         }\n\n         if(imgUrl==\"\"){\n            var headUrl = \"p_head_woman\";\n            if(player&&player.getGender() == 1){\n                headUrl = \"p_head_man\";\n            }\n            cc.loader.loadRes(headUrl,cc.SpriteFrame,function(err,spriteFrame){\n                self.head.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n            });\n            return;\n        }\n\n        imgUrl = imgUrl + \"?aa=aa.jpg\";\n        cc.loader.load(imgUrl, function(err, texture){\n            self.head.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n        });\n    },\n    btn1Click(){\n        console.log(\" 拖鞋\")\n        if(!this.canClick)\n            return;\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        this.node.destroy();\n\n        var args = this.args;\n        var expressionId = 0;\n        var emoticonType = 2 //1:表情包，2:表情包道具\n        if(config.tableInfo){\n            expressionId = config.tableInfo.emoticon_items[0];\n        }\n        var data = {sendSeatId : args.sendSeatId, receiveSeatId : args.receiveSeatId, emoticonType : emoticonType, id : expressionId}\n        GameNetMgr.sendRequest(\"Game\",\"emoticon\",data);\n    },\n    btn2Click(){\n        console.log(\" 鸡蛋\")\n        if(!this.canClick)\n            return;\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        this.node.destroy();\n\n        var args = this.args;\n        var expressionId = 0;\n        var emoticonType = 2 //1:表情包，2:表情包道具\n        if(config.tableInfo){\n            expressionId = config.tableInfo.emoticon_items[1];\n        }\n        var data = {sendSeatId : args.sendSeatId, receiveSeatId : args.receiveSeatId, emoticonType : emoticonType, id : expressionId}\n        GameNetMgr.sendRequest(\"Game\",\"emoticon\",data);\n    },\n    btn3Click(){\n        console.log(\" 点赞\")\n        if(!this.canClick)\n            return;\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        this.node.destroy();\n\n        var args = this.args;\n        var expressionId = 0;\n        var emoticonType = 2 //1:表情包，2:表情包道具\n        if(config.tableInfo){\n            expressionId = config.tableInfo.emoticon_items[2];\n        }\n        var data = {sendSeatId : args.sendSeatId, receiveSeatId : args.receiveSeatId, emoticonType : emoticonType, id : expressionId}\n        GameNetMgr.sendRequest(\"Game\",\"emoticon\",data);\n    },\n    btn4Click(){\n        console.log(\" 鲜花\")\n        if(!this.canClick)\n            return;\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n        this.node.destroy();\n\n        var args = this.args;\n        var expressionId = 0;\n        var emoticonType = 2 //1:表情包，2:表情包道具\n        if(config.tableInfo){\n            expressionId = config.tableInfo.emoticon_items[3];\n        }\n        var data = {sendSeatId : args.sendSeatId, receiveSeatId : args.receiveSeatId, emoticonType : emoticonType, id : expressionId}\n        GameNetMgr.sendRequest(\"Game\",\"emoticon\",data);\n    },\n});\n"]}