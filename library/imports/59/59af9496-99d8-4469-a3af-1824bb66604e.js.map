{"version":3,"sources":["../../../../../assets/Script/dialog/assets/Script/dialog/emailControl.js"],"names":["emailItemControl","require","GameNetMgr","EventHelper","config","dialogManager","PlayerDetailModel","cc","Class","extends","Component","properties","btnLeft_1","default","type","Sprite","btnLeft_2","btnRight_1","btnRight_2","content","Node","emailItem","Prefab","start","self","enabled","sendRequest","AddCustomEvent","MyNode","onMailResult","onReadMailResult","onGetMailAttachmentResult","closeClick","console","log","RemoveCustomEvent","node","destroy","leftClick","rightClick","event","response","getUserData","list","data","i","length","info","instantiate","parent","task","getComponent","init","id","subject","create_time","text","coins","coupon","propItems","k","v","name","num","showCommonDialog"],"mappings":";;;;;;AACA,IAAIA,mBAAmBC,QAAQ,kBAAR,CAAvB;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;AACA,IAAIE,cAAcF,QAAQ,aAAR,CAAlB;AACA,IAAIG,SAASH,QAAQ,QAAR,CAAb;AACA,IAAII,gBAAgBJ,QAAQ,eAAR,CAApB;AACA,IAAIK,oBAAoBL,QAAQ,mBAAR,CAAxB;AACAM,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAY;AACRC,qBAAU,IADF;AAERC,kBAAOP,GAAGQ;AAFF,SADJ;AAKRC,mBAAY;AACRH,qBAAU,IADF;AAERC,kBAAOP,GAAGQ;AAFF,SALJ;AASRE,oBAAa;AACTJ,qBAAU,IADD;AAETC,kBAAOP,GAAGQ;AAFD,SATL;AAaRG,oBAAa;AACTL,qBAAU,IADD;AAETC,kBAAOP,GAAGQ;AAFD,SAbL;AAiBRI,iBAAU;AACNN,qBAAU,IADJ;AAENC,kBAAOP,GAAGa;AAFJ,SAjBF;AAqBRC,mBAAY;AACRR,qBAAU,IADF;AAERC,kBAAOP,GAAGe;AAFF;AArBJ,KAHP;AA6BLC,SA7BK,mBA6BI;AACL,YAAIC,OAAO,IAAX;AACA,aAAKP,UAAL,CAAgBQ,OAAhB,GAA0B,KAA1B;;AAEAvB,mBAAWwB,WAAX,CAAuB,QAAvB,EAAgC,MAAhC;AACAvB,oBAAYwB,cAAZ,CAA2BvB,OAAOwB,MAAlC,EAAyC,YAAzC,EAAsDJ,KAAKK,YAA3D,EAAwEL,IAAxE;AACArB,oBAAYwB,cAAZ,CAA2BvB,OAAOwB,MAAlC,EAAyC,gBAAzC,EAA0DJ,KAAKM,gBAA/D,EAAgFN,IAAhF;AACArB,oBAAYwB,cAAZ,CAA2BvB,OAAOwB,MAAlC,EAAyC,yBAAzC,EAAmEJ,KAAKO,yBAAxE,EAAkGP,IAAlG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,KA/CI;AAgDLQ,cAhDK,wBAgDO;AACRC,gBAAQC,GAAR,CAAY,aAAZ;AACA,YAAIV,OAAO,IAAX;AACArB,oBAAYgC,iBAAZ,CAA8B/B,OAAOwB,MAArC,EAA4C,YAA5C,EAAyDJ,KAAKK,YAA9D,EAA2EL,IAA3E;AACArB,oBAAYgC,iBAAZ,CAA8B/B,OAAOwB,MAArC,EAA4C,gBAA5C,EAA6DJ,KAAKM,gBAAlE,EAAmFN,IAAnF;AACArB,oBAAYgC,iBAAZ,CAA8B/B,OAAOwB,MAArC,EAA4C,yBAA5C,EAAsEJ,KAAKO,yBAA3E,EAAqGP,IAArG;AACA,aAAKY,IAAL,CAAUC,OAAV;AACH,KAvDI;AAwDLC,aAxDK,uBAwDM;AACPL,gBAAQC,GAAR,CAAY,YAAZ;AACA,aAAKtB,SAAL,CAAea,OAAf,GAAyB,IAAzB;AACA,aAAKR,UAAL,CAAgBQ,OAAhB,GAA0B,KAA1B;AACH,KA5DI;AA6DLc,cA7DK,wBA6DO;AACRN,gBAAQC,GAAR,CAAY,aAAZ;AACA,aAAKtB,SAAL,CAAea,OAAf,GAAyB,KAAzB;AACA,aAAKR,UAAL,CAAgBQ,OAAhB,GAA0B,IAA1B;AACH,KAjEI;AAkELI,gBAlEK,wBAkEQW,KAlER,EAkEc;AACf,YAAIC,WAAWD,MAAME,WAAN,EAAf;AACAT,gBAAQC,GAAR,CAAYO,QAAZ;AACA,YAAIE,OAAOF,SAASG,IAAT,CAAcD,IAAzB;AACA,aAAI,IAAIE,IAAI,CAAZ,EAAcA,IAAEF,KAAKG,MAArB,EAA4BD,GAA5B,EAAgC;AAC5B,gBAAIE,OAAOJ,KAAKE,CAAL,CAAX;AACA,gBAAIxB,YAAYd,GAAGyC,WAAH,CAAe,KAAK3B,SAApB,CAAhB;AACAA,sBAAU4B,MAAV,GAAmB,KAAK9B,OAAxB;AACA,gBAAI+B,OAAO7B,UAAU8B,YAAV,CAAuBnD,gBAAvB,CAAX;AACAkD,iBAAKE,IAAL,CAAUL,IAAV,EAAeA,KAAKM,EAApB,EAAuBN,KAAKO,OAA5B,EAAoCP,KAAK5B,OAAzC,EAAiD4B,KAAKQ,WAAtD;AACH;AACJ,KA7EI;AA8ELzB,oBA9EK,4BA8EYU,KA9EZ,EA8EkB;AACnB,YAAIC,WAAWD,MAAME,WAAN,EAAf;AACAT,gBAAQC,GAAR,CAAYO,QAAZ;AACH,KAjFI;AAkFLV,6BAlFK,qCAkFqBS,KAlFrB,EAkF2B;AAC5B,YAAIC,WAAWD,MAAME,WAAN,EAAf;AACAT,gBAAQC,GAAR,CAAYO,QAAZ;AACA,YAAIe,OAAO,KAAX;AACA,YAAIf,SAASG,IAAT,CAAca,KAAlB,EAAwB;AAAC;AACrB;AACAD,mBAAOA,OAAO,MAAP,GAAgBf,SAASG,IAAT,CAAca,KAArC;AACH;AACD,YAAIhB,SAASG,IAAT,CAAcc,MAAlB,EAAyB;AAAE;AACvB;AACAF,mBAAOA,OAAO,MAAP,GAAgBf,SAASG,IAAT,CAAcc,MAArC;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA,YAAIjB,SAASG,IAAT,CAAce,SAAlB,EAA4B;AACxB,iBAAKC,CAAL,IAAUnB,SAASG,IAAT,CAAce,SAAxB,EAAkC;AAC9B,oBAAIE,IAAIpB,SAASG,IAAT,CAAce,SAAd,CAAwBC,CAAxB,CAAR;AACAJ,uBAAOA,OAAO,MAAP,GAAgBK,EAAEC,IAAlB,GAAyBD,EAAEE,GAA3B,GAAgC,GAAvC;AACH;AACJ;AACD;AACA;AACA;;AAEA1D,sBAAc2D,gBAAd,CAA+B,MAA/B,EAAsCR,IAAtC;AACH;AA/GI,CAAT","file":"emailControl.js","sourceRoot":"../../../../../assets/Script/dialog","sourcesContent":["\nvar emailItemControl = require(\"emailItemControl\");\nvar GameNetMgr = require(\"GameNetMgr\");\nvar EventHelper = require(\"EventHelper\");\nvar config = require(\"config\");\nvar dialogManager = require(\"dialogManager\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnLeft_1 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnLeft_2 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnRight_1 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnRight_2 : {\n            default : null,\n            type : cc.Sprite\n        },\n        content : {\n            default : null,\n            type : cc.Node\n        },\n        emailItem : {\n            default : null,\n            type : cc.Prefab\n        },\n    },\n    start () {\n        var self = this;\n        this.btnRight_1.enabled = false;\n\n        GameNetMgr.sendRequest(\"System\",\"Mail\");\n        EventHelper.AddCustomEvent(config.MyNode,\"MailResult\",self.onMailResult,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"ReadMailResult\",self.onReadMailResult,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"GetMailAttachmentResult\",self.onGetMailAttachmentResult,self);\n\n        // var testItem=[1,1,1,1,2,2,2,2,2,2];\n        // var disBetween = 130;\n        // for(var i = 0;i < testItem.length;i++){\n        //     var emailItem = cc.instantiate(this.emailItem);\n        //     emailItem.parent = this.content;\n        //     var task = emailItem.getComponent(emailItemControl);\n        //     task.init(testItem[i],i,\"标题\"+i,\"内容111。。。\",\"2018-05-28 08:36\");\n        // }\n        // this.content.height = disBetween*testItem.length;\n    },\n    closeClick(){\n        console.log(\"close click\");\n        var self = this;\n        EventHelper.RemoveCustomEvent(config.MyNode,\"MailResult\",self.onMailResult,self);\n        EventHelper.RemoveCustomEvent(config.MyNode,\"ReadMailResult\",self.onReadMailResult,self);\n        EventHelper.RemoveCustomEvent(config.MyNode,\"GetMailAttachmentResult\",self.onGetMailAttachmentResult,self);\n        this.node.destroy();\n    },\n    leftClick(){\n        console.log(\"left click\");\n        this.btnLeft_1.enabled = true;\n        this.btnRight_1.enabled = false;\n    },\n    rightClick(){\n        console.log(\"right click\");\n        this.btnLeft_1.enabled = false;\n        this.btnRight_1.enabled = true; \n    },\n    onMailResult(event){\n        var response = event.getUserData();\n        console.log(response);\n        var list = response.data.list;\n        for(var i = 0;i<list.length;i++){\n            var info = list[i];\n            var emailItem = cc.instantiate(this.emailItem);\n            emailItem.parent = this.content;\n            var task = emailItem.getComponent(emailItemControl);\n            task.init(info,info.id,info.subject,info.content,info.create_time);\n        }\n    },\n    onReadMailResult(event){\n        var response = event.getUserData();\n        console.log(response);\n    },\n    onGetMailAttachmentResult(event){\n        var response = event.getUserData();\n        console.log(response);\n        var text = \"恭喜您\";\n        if (response.data.coins){//乐豆\n            // model:setCoin(model:getCoin() + response.data.coins)\n            text = text + \"获得乐豆\" + response.data.coins;\n        }\n        if (response.data.coupon){ //乐劵\n            // model:setCoupon(model:getCoupon() + response.data.coupon)\n            text = text + \"获得乐劵\" + response.data.coupon;\n        }\n        // if (response.data.lottery){//抽奖次数\n        //     text = text + \"获得抽奖次数\" + response.data.lottery;\n        // }\n        // if (response.data.propDress){//--皮肤\n        //     // model:setPropDress(response.data.propDress)\n        // }\n        if (response.data.propItems){\n            for (k in response.data.propItems){\n                var v = response.data.propItems[k];\n                text = text + \"获得道具\" + v.name + v.num +\"个\";\n            }\n        }\n        // if (response.data.other){ //其他奖项\n        //     text = text + \"获得\" + response.data.other;\n        // }\n\n        dialogManager.showCommonDialog(\"温馨提示\",text);\n    }\n});\n"]}