{"version":3,"sources":["TaskCompleteShareControl.js"],"names":["GameNetMgr","require","PlayerDetailModel","config","cc","Class","extends","Component","properties","img_bg","default","type","Sprite","img_head","btn_enter","Node","opentype","onLoad","dialogName","start","show","loadImage","setHeadUrl","self","imgUrl","wxInfo","avatarUrl","headUrl","getGender","loader","loadRes","SpriteFrame","err","spriteFrame","getComponent","load","texture","closeClick","console","log","node","destroy","vv","audioMgr","playSFX","btnEnterClick","shareType","index","getRandom","shareTxt","shareImg","getShareImgPath","wx","shareAppMessage","title","imageUrl","query","uid","success","res","fail"],"mappings":"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","file":"TaskCompleteShareControl.js","sourceRoot":"../../../../../assets/Script/myCreate","sourcesContent":["var GameNetMgr = require(\"GameNetMgr\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar config = require(\"config\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        img_bg : {\n            default : null,\n            type : cc.Sprite\n        },\n        img_head : {\n            default : null,\n            type : cc.Sprite\n        },\n        btn_enter : {\n            default : null,\n            type : cc.Node,\n            opentype : \"share\"\n        },\n    },\n    onLoad () {\n        // 获取乐券和打出春天公用\n        this.dialogName = \"\";\n    },\n    start () {\n        // this.show(\"chuntian\");\n    },   \n    show(dialogName){\n        this.dialogName = dialogName;\n        if(dialogName == \"lequan\"){\n            config.loadImage(this.img_bg,\"p_get_lequan\");\n        }else if(dialogName == \"chuntian\"){\n            config.loadImage(this.img_bg,\"p_chuntian\");\n        }else if(dialogName == \"liansheng_3\"){\n            config.loadImage(this.img_bg,\"p_liansheng_3\");\n        }\n        this.setHeadUrl();\n    },\n    setHeadUrl(){\n        var self = this;\n         //设置微信头像\n         var imgUrl=config.wxInfo.avatarUrl;\n\n         if(imgUrl==\"\"){\n            var headUrl = \"p_head_woman\";\n            if(PlayerDetailModel.getGender() == 1){\n                headUrl = \"p_head_man\";\n            }\n            cc.loader.loadRes(headUrl,cc.SpriteFrame,function(err,spriteFrame){\n                self.img_head.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n            });\n            return;\n        }\n\n        imgUrl = imgUrl + \"?aa=aa.jpg\";\n        cc.loader.load(imgUrl, function(err, texture){\n            self.img_head.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n        });\n    },\n    closeClick(){\n        console.log(\"close click\");\n        this.node.destroy();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    btnEnterClick(){\n        console.log(\"btnEnter click\");\n\n        var dialogName = this.dialogName; //lequan 5  //chuntian  5\n        var shareType = 5;\n        if(dialogName == \"lequan\"){\n            shareType = 5;\n        }else if(dialogName == \"chuntian\"){\n            shareType = 5;\n        }else if(dialogName == \"liansheng_3\"){\n            shareType = 5;\n        }\n\n        var index = config.getRandom(1);\n        var shareTxt = config.shareTxt[dialogName][index];\n        console.log(\">>>shareTxt:\",shareTxt);\n\n        var shareImg = config.getShareImgPath(dialogName);\n        console.log(\">>>shareImg:\",shareImg);\n    \n        wx.shareAppMessage({\n            title: shareTxt,\n            imageUrl: shareImg,\n            query : \"key=\"+PlayerDetailModel.uid,\n            success(res){\n                console.log(\"---转发成功!!!\");\n                console.log(res);\n                // GameNetMgr.sendRequest(\"System\",\"ShareWxRes\",shareType);\n            },\n            fail(res){\n                console.log(\"---转发失败!!!\")\n            } \n        })\n\n        this.node.destroy();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    }\n});\n"]}