{"version":3,"sources":["AppStart.js"],"names":["config","require","ByteArray","Protocol","EventHelper","PlayerDetailModel","dialogManager","MD5","initMgr","cc","vv","http","net","Class","extends","Component","properties","labLoading","default","type","Label","onLoad","getServerInfo","myNode","Node","addPersistRootNode","isShow","params","env","ver","channel","udid","pver","pchannel","presver","self","xhr","complete","fnRequest","console","log","string","sendRequest","ret","GlobalRouterUpdate","GlobalRouter","host","port","connectGameServer","director","setTimeout","fn","abort","connect","sendRegist","ConnectionClosedShow","showCommonDialog","loadScene","setInterval","isPinging","sendHeartBeat","bind","AddCustomEvent","MyNode","onRegist","onHeartBeat","onLoginOK","getWxUserInfo","wx","getUserInfo","success","res","JSON","stringify","userInfo","UpdateWxInfo","event","data","getUserData","temppassword","password","sendLogin","setPlayerDetailModel","t","Request","HeartBeat","Alive","send","Command","_d","hex_md5","wxInfo","nickName","Login","Regist","d","u","v","c","e","Guest","p","tv","wn","wurl","avatarUrl","response","room","Response","OK","isDevData","i","length","rooms","j","modelId","playGameId","playGameMsg","nickname","uid","parseInt","coin","gold","gender","word","coolnum","level","matches","win","checkCode","propDress","score","verfile","vertips","mailUnread","coupon","age","contact","contacts","wechat","lottery","checkinUndo","task1Unaward","task2Unaward","chargeRate","propItems","rewardList","wechatImg","title","isDev","preloadNextScene","preloadScene"],"mappings":"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","file":"AppStart.js","sourceRoot":"../../../../../assets/Script/gameNetwork","sourcesContent":["var config = require(\"config\");\nvar ByteArray = require(\"ByteArray\");\nvar Protocol = require(\"Protocol\");\nvar EventHelper = require(\"EventHelper\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\nvar dialogManager = require(\"dialogManager\");\nvar MD5 = require(\"md5\");\n\nfunction initMgr(){\n    cc.vv = {};\n    cc.vv.http = require(\"HTTP\");\n    cc.vv.net = require(\"GameNet\");\n    // cc.vv.net = require(\"Net\");\n}\n   \ncc.Class({\n    extends: cc.Component,\n    properties: {\n        labLoading : {\n            default : null,\n            type : cc.Label\n        },\n    },\n    // use this for initialization\n    onLoad: function () {\n        initMgr();\n        this.getServerInfo();\n        //设置常驻节点\n        var myNode = new cc.Node(\"myNode\");\n        EventHelper.addPersistRootNode(myNode);\n        this.isShow = false;\n\n        // wx.showShareMenu({\n        //     withShareTicket: true\n        // });\n        // cc.loader.loadRes(\"img_dialog/p_sharebg\",function(err,data){\n        //     wx.onShareAppMessage(function(res){\n        //         return {\n        //             title: \"有乐斗地主等你来战！\",\n        //             imageUrl: data.url,\n        //             query : PlayerDetailModel.uid,\n        //             success(res){\n        //                 console.log(\"转发成功!!!\")\n        //                 console.log(res);\n        //                 // common.diamond += 20;\n        //             },\n        //             fail(res){\n        //                 console.log(\"转发失败!!!\")\n        //             } \n        //         }\n        //     })\n        // });\n    },\n    getServerInfo:function(){\n        var params = {};\n        params.env = \"prod\";\n        params.ver = \"1.0.0\";\n        params.channel = \"weichatgame\";\n        params.udid = \"udid\";\n        params.pver = \"1.0.0\";\n        params.pchannel = \"weichatgame\";\n        params.presver = \"1.0.0\";\n        \n        var self = this;\n        var xhr = null;\n        var complete = false;\n        var fnRequest = function(){\n            console.log(\"正在连接服务器...\");\n            self.labLoading.string = \"正在连接服务器...\";\n            xhr = cc.vv.http.sendRequest(\"\",params,function(ret){\n                console.log(\"连接成功\");\n                self.labLoading.string = \"连接成功...\";\n                xhr = null;\n                complete = true;\n                config.GlobalRouterUpdate(ret);\n                console.log(\"host:\"+config.GlobalRouter.host+\":\"+config.GlobalRouter.port);\n                self.connectGameServer();\n            },config.GlobalRouter.director);\n            setTimeout(fn,5000);            \n        };\n        \n        var fn = function(){\n            if(!complete){\n                if(xhr){\n                    xhr.abort();\n                    console.log(\"连接失败，即将重试...\");\n                    self.labLoading.string = \"连接失败，即将重试...\";\n                    setTimeout(function(){\n                        fnRequest();\n                    },5000);\n                }\n                else{\n                    fnRequest();\n                }\n            }\n        };\n        fn();\n    },\n    connectGameServer(){\n        var self = this;\n        cc.vv.net.connect(config.GlobalRouter.host,config.GlobalRouter.port,function(ret){\n            //WebSocket连接成功\n            self.sendRegist();\n            // self.getWxUserInfo();\n        });\n\n        var ConnectionClosedShow = function(){\n            self.isShow = true;\n            dialogManager.showCommonDialog(\"提示\",\"与服务器断开连接！\",function(){\n                self.isShow = false;\n                cc.director.loadScene(\"LoadingScene\");\n            });\n        }\n\n        setInterval(function(){\n            if(cc.vv.net.isPinging){\n                self.sendHeartBeat();\n            }else{\n                if(!self.isShow)\n                    ConnectionClosedShow();\n            }     \n        }.bind(this),10000);\n\n        EventHelper.AddCustomEvent(config.MyNode,\"Regist\",self.onRegist,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"HeartBeat\",self.onHeartBeat,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"LoginOK\",self.onLoginOK,self);  \n    },\n    getWxUserInfo(){\n        var self = this; \n        wx.getUserInfo({\n            success: function (res) {\n               console.log(\"res.userInfo = \" + JSON.stringify(res.userInfo));\n               config.UpdateWxInfo(res.userInfo);\n               self.sendRegist();\n             },\n       })\n    },\n    onRegist(event){\n        var self = this;\n        console.log(\"Regist---\");\n        var data = event.getUserData();\n        config.temppassword = data.data.data.password;\n        self.sendLogin();\n    },\n    onHeartBeat(event){\n        // console.log(\"HeartBeat---\");\n    },\n    onLoginOK(event){\n        var self = this;\n        console.log(\"LoginOK---\");\n        console.log(event.getUserData());\n        var data = event.getUserData();\n        self.setPlayerDetailModel(data);\n    },\n    sendHeartBeat(){\n        //发送心跳\n        var params = {};\n        params.t = Protocol.Request.HeartBeat.Alive;\n        cc.vv.net.send(\"HeartBeat\",Protocol.Command.HeartBeat,params);\n    },\n    sendRegist(){\n        //注册请求\n        var _d = MD5.hex_md5(\"yepat2\");\n        if(config.wxInfo.nickName !=\"\"){\n            _d = MD5.hex_md5(config.wxInfo.nickName);\n        }\n        var params = {};\n        params.t = Protocol.Request.Login.Regist;\n        params.d = _d;\n        params.u = \"50ee8041a7fd8baa6348252ea114432bb3be23bd\";\n        params.v = \"2.1.1\";\n        params.c = \"sjweichat\";\n        params.e = \"defaults\";\n        params.type = \"guest\";\n        cc.vv.net.send(\"Regist\",Protocol.Command.Login,params);  \n    },\n    sendLogin(){\n        var _d = MD5.hex_md5(\"yepat2\");\n        if(config.wxInfo.nickName !=\"\"){\n            _d = MD5.hex_md5(config.wxInfo.nickName);\n        }\n        var params = {};\n        params.t = Protocol.Request.Login.Guest;\n        params.d = _d;\n        params.p = config.temppassword;\n        params.c = \"sjweichat\";\n        params.v = \"2.1.1\";\n        params.tv = 1;\n        params.e = \"defaults\";\n        params.wn = config.wxInfo.nickName;\n        params.wurl = config.wxInfo.avatarUrl;\n        cc.vv.net.send(\"Login\",Protocol.Command.Login,params);  \n    },\n    setPlayerDetailModel(response){\n        var room = response.data.room\n        console.log(room);\n        if(response[\"code\"] == Protocol.Response.Login.OK){\n            var isDevData = response[\"data\"][\"isDev\"];\n            if (isDevData && typeof(isDevData) == \"number\"){\n            }else{\n                isDevData = 0\n            }\n            for(var i=0;i<room.length;i++){\n                if(room[i].rooms){\n                    for(var j=0;j<room[i].rooms.length;j++){\n                        room[i].rooms[j].modelId = room[i].modelId;\n                    }\n                }\n            }\n            config.playGameId = response[\"data\"].playGameId;\n            config.playGameMsg = response[\"data\"].playGameMsg;\n\n    \n            PlayerDetailModel.nickname = response[\"data\"][\"nick\"];\n            PlayerDetailModel.uid = parseInt(response[\"data\"][\"uid\"]);\n            PlayerDetailModel.coin = parseInt(response[\"data\"][\"coins\"]);\n            PlayerDetailModel.gold = parseInt(response[\"data\"][\"gold\"]);\n            PlayerDetailModel.gender = parseInt(response[\"data\"][\"sex\"]);\n            PlayerDetailModel.word = response[\"data\"][\"word\"];\n            PlayerDetailModel.coolnum = response[\"data\"][\"cool_num\"];\n            PlayerDetailModel.level = parseInt(response[\"data\"][\"level\"]);\n            PlayerDetailModel.matches = parseInt(response[\"data\"][\"gameData\"][\"matches\"]);\n            PlayerDetailModel.win = parseInt(response[\"data\"][\"gameData\"][\"win\"]);\n            PlayerDetailModel.checkCode = response[\"data\"][\"check_code\"];\n            PlayerDetailModel.propDress = response[\"data\"][\"propDress\"];\n            PlayerDetailModel.score = parseInt(response[\"data\"][\"score\"]);\n\n            PlayerDetailModel.verfile = parseInt(response[\"data\"][\"verfile\"]);\n            PlayerDetailModel.vertips = parseInt(response[\"data\"][\"vertips\"]);\n            PlayerDetailModel.mailUnread = parseInt(response[\"data\"][\"mail_unread\"]);\n            PlayerDetailModel.coupon = parseInt(response[\"data\"][\"coupon\"]);\n            PlayerDetailModel.age = parseInt(response[\"data\"][\"age\"]);\n            PlayerDetailModel.room = room;\n            PlayerDetailModel.contact = response[\"data\"][\"contact\"];\n            PlayerDetailModel.contacts = response[\"data\"][\"contacts\"];\n            PlayerDetailModel.wechat = response[\"data\"][\"wechat\"];\n\n            PlayerDetailModel.lottery = parseInt(response[\"data\"][\"lottery\"]);\n            PlayerDetailModel.checkinUndo = parseInt(response[\"data\"][\"checkin_undo\"]);\n            PlayerDetailModel.task1Unaward = parseInt(response[\"data\"][\"task1_unaward\"]);\n            PlayerDetailModel.task2Unaward = parseInt(response[\"data\"][\"task2_unaward\"]);\n            PlayerDetailModel.chargeRate = parseInt(response[\"data\"][\"charge_rate\"]);\n            PlayerDetailModel.propItems = response[\"data\"][\"propItems\"];\n\n            PlayerDetailModel.rewardList = response[\"data\"][\"n_reward_list\"];\n\n            PlayerDetailModel.wechatImg = response[\"data\"][\"img\"];\n            PlayerDetailModel.title = response[\"data\"][\"title\"];\n            PlayerDetailModel.isDev = isDevData;\n\n            console.log(\"进入游戏大厅...uid:\"+parseInt(response[\"data\"][\"uid\"]));\n            this.labLoading.string = \"进入游戏大厅...\";\n            this.preloadNextScene();\n        }else{\n            console.log(\"登陆游戏失败！\");\n            this.labLoading.string = \"登陆游戏失败！\";\n            dialogManager.showCommonDialog(\"提示\",\"登陆游戏失败！\",function(){\n                cc.director.loadScene(\"LoadingScene\");\n            });\n            \n        }\n    },\n     //\n     preloadNextScene(){\n        cc.director.preloadScene(\"HallScene\", function () {\n            cc.log(\"Next scene preloaded\");\n            cc.director.loadScene(\"HallScene\");\n        });\n    }\n});\n"]}