{"version":3,"sources":["emailControl.js"],"names":["emailItemControl","require","GameNetMgr","EventHelper","config","dialogManager","PlayerDetailModel","cc","Class","extends","Component","properties","btnLeft_1","default","type","Sprite","btnLeft_2","btnRight_1","btnRight_2","content","Node","emailItem","Prefab","label_noEmail","Label","start","self","node","active","sendRequest","AddCustomEvent","MyNode","onMailResult","onReadMailResult","onGetMailAttachmentResult","closeClick","console","log","RemoveCustomEvent","destroy","vv","audioMgr","playSFX","leftClick","rightClick","event","response","getUserData","list","data","length","i","info","instantiate","parent","task","getComponent","init","id","subject","create_time","text","coins","coupon","propItems","k","v","name","num","showCommonDialog"],"mappings":"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","file":"emailControl.js","sourceRoot":"../../../../../assets/Script/dialog","sourcesContent":["\nvar emailItemControl = require(\"emailItemControl\");\nvar GameNetMgr = require(\"GameNetMgr\");\nvar EventHelper = require(\"EventHelper\");\nvar config = require(\"config\");\nvar dialogManager = require(\"dialogManager\");\nvar PlayerDetailModel = require(\"PlayerDetailModel\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnLeft_1 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnLeft_2 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnRight_1 : {\n            default : null,\n            type : cc.Sprite\n        },\n        btnRight_2 : {\n            default : null,\n            type : cc.Sprite\n        },\n        content : {\n            default : null,\n            type : cc.Node\n        },\n        emailItem : {\n            default : null,\n            type : cc.Prefab\n        },\n        label_noEmail : {\n            default : null,\n            type : cc.Label\n        },\n    },\n    start () {\n        var self = this;\n        // this.btnRight_1.enabled = false;\n\n        this.label_noEmail.node.active = false;\n        GameNetMgr.sendRequest(\"System\",\"Mail\");\n        EventHelper.AddCustomEvent(config.MyNode,\"MailResult\",self.onMailResult,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"ReadMailResult\",self.onReadMailResult,self);\n        EventHelper.AddCustomEvent(config.MyNode,\"GetMailAttachmentResult\",self.onGetMailAttachmentResult,self);\n    },\n    closeClick(){\n        console.log(\"close click\");\n        var self = this;\n        EventHelper.RemoveCustomEvent(config.MyNode,\"MailResult\",self.onMailResult,self);\n        EventHelper.RemoveCustomEvent(config.MyNode,\"ReadMailResult\",self.onReadMailResult,self);\n        EventHelper.RemoveCustomEvent(config.MyNode,\"GetMailAttachmentResult\",self.onGetMailAttachmentResult,self);\n        this.node.destroy();\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    leftClick(){\n        // console.log(\"left click\");\n        // this.btnLeft_1.enabled = true;\n        // this.btnRight_1.enabled = false;\n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    rightClick(){\n        // console.log(\"right click\");\n        // this.btnLeft_1.enabled = false;\n        // this.btnRight_1.enabled = true; \n        cc.vv.audioMgr.playSFX(\"SpecOk\");\n    },\n    onMailResult(event){\n        var response = event.getUserData();\n        console.log(response);\n        var list = response.data.list;\n\n        if(list.length == 0){\n            this.label_noEmail.node.active = true;\n        }\n        for(var i = 0;i<list.length;i++){\n            var info = list[i];\n            var emailItem = cc.instantiate(this.emailItem);\n            emailItem.parent = this.content;\n            var task = emailItem.getComponent(emailItemControl);\n            task.init(info,info.id,info.subject,info.content,info.create_time);\n        }\n    },\n    onReadMailResult(event){\n        var response = event.getUserData();\n        console.log(response);\n    },\n    onGetMailAttachmentResult(event){\n        var response = event.getUserData();\n        console.log(response);\n        var text = \"恭喜您\";\n        if (response.data.coins){//乐豆\n            text = text + \"获得乐豆\" + response.data.coins;\n        }\n        if (response.data.coupon){ //乐劵\n            text = text + \"获得乐劵\" + response.data.coupon;\n        }\n        if (response.data.propItems){\n            for (k in response.data.propItems){\n                var v = response.data.propItems[k];\n                text = text + \"获得道具\" + v.name + v.num +\"个\";\n            }\n        }\n        dialogManager.showCommonDialog(\"温馨提示\",text);\n    }\n});\n"]}